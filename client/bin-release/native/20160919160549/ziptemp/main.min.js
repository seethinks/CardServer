var AssetAdapter=function(){function t(){}var e=(__define,t),n=e.prototype;return n.getAsset=function(t,e,n){function i(i){e.call(n,i,t)}if(RES.hasRes(t)){var r=RES.getRes(t);r?i(r):RES.getResAsync(t,i,this)}else RES.getResByUrl(t,i,this,RES.ResourceItem.TYPE_IMAGE)},t}();egret.registerClass(AssetAdapter,"AssetAdapter",["eui.IAssetAdapter"]);var MergeJsonAnalyzer=function(t){function e(){t.apply(this,arguments),this.mergeJsons=["MergeConfig_json"]}__extends(e,t);var n=(__define,e),i=n.prototype;return i.analyzeData=function(t,e){var n=t.name;if(!this.fileDic[n]&&e)try{var i=JSON.parse(e);if(-1!=this.mergeJsons.indexOf(n))for(var r in i)this.fileDic[r]=i[r];else this.fileDic[n]=i}catch(s){egret.$warn(1017,t.url,e)}},e}(RES.JsonAnalyzer);egret.registerClass(MergeJsonAnalyzer,"MergeJsonAnalyzer");var ThemeAdapter=function(){function t(){}var e=(__define,t),n=e.prototype;return n.getTheme=function(t,e,n,i){function r(t){e.call(i,t)}function s(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),n.call(i))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),RES.getResByUrl(t,r,this,RES.ResourceItem.TYPE_TEXT)},t}();egret.registerClass(ThemeAdapter,"ThemeAdapter",["eui.IThemeAdapter"]);var App=function(){function t(){}var e=__define,n=t;n.prototype;return e(t,"Http",function(){return Http.getInstance()}),e(t,"Socket",function(){return Socket.getInstance()}),e(t,"ControllerManager",function(){return ControllerManager.getInstance()}),e(t,"ViewManager",function(){return ViewManager.getInstance()}),e(t,"SceneManager",function(){return SceneManager.getInstance()}),e(t,"DebugUtils",function(){return DebugUtils.getInstance()}),e(t,"MessageCenter",function(){return MessageCenter.getInstance(0)}),e(t,"TimerManager",function(){return TimerManager.getInstance()}),e(t,"DateUtils",function(){return DateUtils.getInstance()}),e(t,"MathUtils",function(){return MathUtils.getInstance()}),e(t,"RandomUtils",function(){return RandomUtils.getInstance()}),e(t,"DisplayUtils",function(){return DisplayUtils.getInstance()}),e(t,"BitmapNumber",function(){return BitmapNumber.getInstance()}),e(t,"GuideUtils",function(){return GuideUtils.getInstance()}),e(t,"StageUtils",function(){return StageUtils.getInstance()}),e(t,"EffectUtils",function(){return EffectUtils.getInstance()}),e(t,"StringUtils",function(){return StringUtils.getInstance()}),e(t,"CommonUtils",function(){return CommonUtils.getInstance()}),e(t,"SoundManager",function(){return SoundManager.getInstance()}),e(t,"DeviceUtils",function(){return DeviceUtils.getInstance()}),e(t,"EgretExpandUtils",function(){return EgretExpandUtils.getInstance()}),e(t,"KeyboardUtils",function(){return KeyboardUtils.getInstance()}),e(t,"RockerUtils",function(){return RockerUtils.getInstance()}),e(t,"ShockUtils",function(){return ShockUtils.getInstance()}),e(t,"ResourceUtils",function(){return ResourceUtils.getInstance()}),e(t,"RenderTextureManager",function(){return RenderTextureManager.getInstance()}),e(t,"TextFlowMaker",function(){return TextFlowMaker.getInstance()}),e(t,"NotificationCenter",function(){return null==t._notificationCenter&&(t._notificationCenter=new MessageCenter(1)),t._notificationCenter}),e(t,"DragonBonesFactory",function(){return DragonBonesFactory.getInstance()}),e(t,"DelayOptManager",function(){return DelayOptManager.getInstance()}),e(t,"ArrayUtils",function(){return ArrayUtils.getInstance()}),e(t,"EasyLoading",function(){return EasyLoading.getInstance()}),e(t,"ResVersionManager",function(){return ResVersionManager.getInstance()}),e(t,"StarlingSwfFactory",function(){return StarlingSwfFactory.getInstance()}),t.Init=function(){t.GlobalData=RES.getRes("global"),t.DebugUtils.isOpen(t.GlobalData.IsDebug),t.DebugUtils.setThreshold(5),t.Http.initServer(t.GlobalData.HttpServer),t.ProtoConfig=RES.getRes(t.GlobalData.ProtoConfig),t.Socket.initServer(t.GlobalData.SocketServer,t.GlobalData.SocketPort,new ByteArrayMsgByProtobuf)},t.ProxyUserFlag="",t.GlobalData=null,t.ProtoFile=null,t.ProtoConfig=null,t}();egret.registerClass(App,"App");var BaseClass=function(){function t(){}var e=(__define,t);e.prototype;return t.getInstance=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var n=this;if(!n._instance){var i=t.length;0==i?n._instance=new n:1==i?n._instance=new n(t[0]):2==i?n._instance=new n(t[0],t[1]):3==i?n._instance=new n(t[0],t[1],t[2]):4==i?n._instance=new n(t[0],t[1],t[2],t[3]):5==i&&(n._instance=new n(t[0],t[1],t[2],t[3],t[4]))}return n._instance},t}();egret.registerClass(BaseClass,"BaseClass");var Keyboard=function(){function t(){}var e=(__define,t);e.prototype;return t.LEFT=37,t.RIGHT=39,t.UP=38,t.DOWN=40,t.W=87,t.A=65,t.S=83,t.D=68,t.J=74,t.K=75,t.L=76,t.U=85,t.I=73,t.O=79,t.P=80,t.SPACE=32,t}();egret.registerClass(Keyboard,"Keyboard");var BitmapNumber=function(t){function e(){t.call(this),this._imgPool=[],this._containerPool=[]}__extends(e,t);var n=(__define,e),i=n.prototype;return i.createNumPic=function(t,e){var n,i=this.getContainer(),r=t.toString(),s=0;for(s;s<r.length;s++)n=this.getSingleNumPic(r.charAt(s),e),i.addChild(n);return this.repositionNumPic(i),i},i.desstroyNumPic=function(t){this.clearContainer(t),t.parent&&t.parent.removeChild(t),this._containerPool.push(t)},i.changeNum=function(t,e,n){var i=e.toString();if(t.numChildren>i.length)for(;t.numChildren>i.length;)this.recycleBM(t.getChildAt(t.numChildren-1));var r,s=0;for(s;s<i.length;s++)s>=t.numChildren&&t.addChild(this.getBitmap()),r=i.charAt(s),r="."==r?"dot":r,t.getChildAt(s).texture=this.getTexture(r,n);this.repositionNumPic(t)},i.repositionNumPic=function(t){var e,n=0,i=0;for(n;n<t.numChildren;n++)e=t.getChildAt(n),e.x=i,i=e.x+e.width},i.clearContainer=function(t){for(;t.numChildren;)this.recycleBM(t.removeChildAt(0))},i.recycleBM=function(t){t&&t.parent&&(t.parent.removeChild(t),t.texture=null,this._imgPool.push(t))},i.getContainer=function(){return this._containerPool.length?this._containerPool.shift():new egret.DisplayObjectContainer},i.getSingleNumPic=function(t,e){"."==t&&(t="dot");var n=this.getBitmap();return n.texture=this.getTexture(t,e),n},i.getTexture=function(t,e){return RES.getRes(e+t)},i.getBitmap=function(){return this._imgPool.length?this._imgPool.shift():new egret.Bitmap},e}(BaseClass);egret.registerClass(BitmapNumber,"BitmapNumber");var HotspotBitmap=function(t){function e(){t.call(this),this._hotspot=[],this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouch,this)}__extends(e,t);var n=(__define,e),i=n.prototype;return i.addHotspotArea=function(t,e,n,i){this._hotspot.push({rect:t,callBack:e,thisObj:n,para:i})},i.onTouch=function(t){for(var e,n=t.localX,i=t.localY,r=0;r<this._hotspot.length;r++)e=this._hotspot[r],e.rect.contains(n,i)&&(e.para?e.callBack.call(e.thisObj,e.para):e.callBack.call(e.thisObj))},e}(egret.Bitmap);egret.registerClass(HotspotBitmap,"HotspotBitmap");var DragonBonesArmature=function(t){function e(e,n){t.call(this),this._armature=e,this._clock=n,this.addChild(this._armature.display),this._completeCalls=[],this._frameCalls=[],this._isPlay=!1,this._playName=""}__extends(e,t);var n=(__define,e),i=n.prototype;return i.addListeners=function(){this._armature.addEventListener(dragonBones.AnimationEvent.COMPLETE,this.completeHandler,this),this._armature.enableCache?this._armature.addEventListener(dragonBones.FrameEvent.ANIMATION_FRAME_EVENT,this.frameHandler,this):this._armature.addEventListener(dragonBones.FrameEvent.BONE_FRAME_EVENT,this.frameHandler,this)},i.removeListeners=function(){this._armature.removeEventListener(dragonBones.AnimationEvent.COMPLETE,this.completeHandler,this),this._armature.enableCache?this._armature.removeEventListener(dragonBones.FrameEvent.ANIMATION_FRAME_EVENT,this.frameHandler,this):this._armature.removeEventListener(dragonBones.FrameEvent.BONE_FRAME_EVENT,this.frameHandler,this)},i.completeHandler=function(t){for(var e=t.animationName,n=0,i=this._completeCalls.length;i>n;n++){var r=this._completeCalls[n];r[0].apply(r[1],[t,e])}e==this._playName&&(this._playName="")},i.frameHandler=function(t){for(var e=0,n=this._frameCalls.length;n>e;e++){var i=this._frameCalls[e];i[0].apply(i[1],[t])}},i.play=function(t,e){return void 0===e&&(e=void 0),this._playName==t?this._currAnimationState:(this._playName=t,this.start(),void 0==e?this._currAnimationState=this.getAnimation().gotoAndPlay(t):this._currAnimationState=this.getAnimation().gotoAndPlay(t,void 0,void 0,e),this._currAnimationState&&(this._currAnimationState.autoTween=!1),this._currAnimationState)},i.start=function(){this._isPlay||(this._clock.add(this._armature),this._isPlay=!0,this.addListeners())},i.stop=function(){this._isPlay&&(this._clock.remove(this._armature),this._isPlay=!1,this._playName="",this.removeListeners())},i.destroy=function(){this.stop(),this.parent&&this.parent.removeChild(this),this.removeChildren(),this._armature=null,this._clock=null,this._completeCalls=null,this._frameCalls=null},i.addCompleteCallFunc=function(t,e){for(var n=0;n<this._completeCalls.length;n++){var i=this._completeCalls[n];if(i[0]==t&&i[1]==e)return}this._completeCalls.unshift([t,e])},i.removeCompleteCallFunc=function(t,e){for(var n=0;n<this._completeCalls.length;n++){var i=this._completeCalls[n];i[0]==t&&i[1]==e&&(this._completeCalls.splice(n,1),n--)}},i.addFrameCallFunc=function(t,e){for(var n=0;n<this._frameCalls.length;n++){var i=this._frameCalls[n];if(i[0]==t&&i[1]==e)return}this._frameCalls.push([t,e])},i.removeFrameCallFunc=function(t,e){for(var n=0;n<this._frameCalls.length;n++){var i=this._frameCalls[n];i[0]==t&&i[1]==e&&(this._frameCalls.splice(n,1),n--)}},i.$onRemoveFromStage=function(){t.prototype.$onRemoveFromStage.call(this),this.stop()},i.getArmature=function(){return this._armature},i.getCurrAnimationState=function(){return this._currAnimationState},i.getClock=function(){return this._clock},i.getAnimation=function(){return this._armature.animation},i.getBone=function(t){return this._armature.getBone(t)},i.getPlayName=function(){return this._playName},i.getBoneDisplay=function(t){return t.slot.getDisplay()},i.changeBone=function(t,e){var n=this.getBone(t);n&&n.slot.setDisplay(e)},e}(egret.DisplayObjectContainer);egret.registerClass(DragonBonesArmature,"DragonBonesArmature");var DragonBonesArmatureContainer=function(t){function e(){t.call(this),this.armatures=new Array,this.actions={},this.cacheBones={}}__extends(e,t);var n=__define,i=e,r=i.prototype;return r.register=function(t,e){this.armatures.push(t);for(var n=0,i=e.length;i>n;n++)this.actions[e[n]]=this.armatures.length-1},n(r,"armature",function(){return this.armatures[this.currArmatureIndex]}),r.getCacheBone=function(t){if(!this.cacheBones[t]){this.cacheBones[t]=[];for(var e=0,n=this.armatures.length;n>e;e++){var i=this.armatures[e];this.cacheBones[t].push(i.getBone(t))}}return this.cacheBones[t][this.currArmatureIndex]},r.play=function(t,e){if(void 0===e&&(e=void 0),null==this.actions[t])return void Log.trace("DragonBonesArmatureContainer不存在动作：",t);var n=this.actions[t];n!=this.currArmatureIndex&&this.remove();var i=this.armatures[n];return i?(this.addChild(i),this.currArmatureIndex=n,i.play(t,e)):null},r.stop=function(){var t=this.armatures[this.currArmatureIndex];t&&t.stop()},r.start=function(){var t=this.armatures[this.currArmatureIndex];t&&t.start()},r.remove=function(){var t=this.armatures[this.currArmatureIndex];t&&(t.stop(),App.DisplayUtils.removeFromParent(t),this.currArmatureIndex=null)},r.addCompleteCallFunc=function(t,e){for(var n=0,i=this.armatures.length;i>n;n++){var r=this.armatures[n];r.addCompleteCallFunc(t,e)}},r.removeCompleteCallFunc=function(t,e){for(var n=0,i=this.armatures.length;i>n;n++){var r=this.armatures[n];r.removeCompleteCallFunc(t,e)}},r.addFrameCallFunc=function(t,e){for(var n=0,i=this.armatures.length;i>n;n++){var r=this.armatures[n];r.addFrameCallFunc(t,e)}},r.removeFrameCallFunc=function(t,e){for(var n=0,i=this.armatures.length;i>n;n++){var r=this.armatures[n];r.removeFrameCallFunc(t,e)}},r.clear=function(){for(;this.armatures.length;){var t=this.armatures.pop();App.DisplayUtils.removeFromParent(t),t.destroy()}this.cacheBones={},this.actions={}},r.destroy=function(){this.clear(),this.armatures=null,this.cacheBones=null,this.actions=null},e}(egret.DisplayObjectContainer);egret.registerClass(DragonBonesArmatureContainer,"DragonBonesArmatureContainer");var DragonBonesFactory=function(t){function e(){t.call(this),this.averageUtils=new AverageUtils,this.factory=new dragonBones.EgretFactory,this.clocks=new Array,this.clocksLen=0,this.files=[],this.start()}__extends(e,t);var n=(__define,e),i=n.prototype;return i.initArmatureFile=function(t,e,n){-1==this.files.indexOf(t.name)&&(this.addSkeletonData(t),this.addTextureAtlas(e,n),this.files.push(t.name))},i.initArmatureMoreFile=function(t){this.factory.addSkeletonData(dragonBones.DataParser.parseDragonBonesData(t));for(var e=t.textureList,n=t.sheetList,i=new EgretTextureAtlasMore(RES.getRes(e[0]),RES.getRes(n[0]),t.name),r=e.length,s=1;r>s;s++)i.register(RES.getRes(e[s]),RES.getRes(n[s]));this.factory.addTextureAtlas(i)},i.removeArmatureFile=function(t){var e=this.files.indexOf(t);-1!=e&&(this.removeSkeletonData(t),this.removeTextureAtlas(t),this.files.splice(e,1))},i.clear=function(){for(;this.files.length;)this.removeArmatureFile(this.files[0])},i.addSkeletonData=function(t){this.factory.addSkeletonData(dragonBones.DataParser.parseDragonBonesData(t))},i.addTextureAtlas=function(t,e){this.factory.addTextureAtlas(new dragonBones.EgretTextureAtlas(t,e))},i.removeSkeletonData=function(t){this.factory.removeSkeletonData(t)},i.removeTextureAtlas=function(t){this.factory.removeTextureAtlas(t)},i.makeArmature=function(t,e,n){void 0===n&&(n=1);var i=this.factory.buildArmature(t,e);if(null==i)return Log.trace("不存在Armature： "+t),null;var r=this.createWorldClock(n),s=new DragonBonesArmature(i,r);return s},i.makeFastArmature=function(t,e,n){void 0===n&&(n=1);var i=this.makeArmature(t,e,n);return i.getArmature().enableAnimationCache(24),i},i.createWorldClock=function(t){for(var e=0;e<this.clocksLen;e++)if(this.clocks[e].timeScale==t)return this.clocks[e];var n=new dragonBones.WorldClock;return n.timeScale=t,this.clocks.push(n),this.clocksLen=this.clocks.length,n},i.onEnterFrame=function(t){this.averageUtils.push(t);for(var e=.001*this.averageUtils.getValue(),n=0;n<this.clocksLen;n++){var i=this.clocks[n];i.advanceTime(e)}},i.stop=function(){this.isPlay&&(App.TimerManager.remove(this.onEnterFrame,this),this.isPlay=!1)},i.start=function(){this.isPlay||(this.isPlay=!0,App.TimerManager.doFrame(1,0,this.onEnterFrame,this))},e}(BaseClass);egret.registerClass(DragonBonesFactory,"DragonBonesFactory");var EgretTextureAtlasMore=function(t){function e(e,n,i,r){void 0===r&&(r=1),t.call(this,e,n,r),this._datas=[],this._textureIndex={},this.name=i,this.register(e,n)}__extends(e,t);var n=(__define,e),i=n.prototype;return i.register=function(t,e){var n=this.parseSingleData(e);this.analysisSheet(n,this._datas.length),this._datas.push([new egret.SpriteSheet(t),n])},i.analysisSheet=function(t,e){for(var n=Object.keys(t),i=0,r=n.length;r>i;i++){var s=n[i];s&&""!=s&&this.addTextureDic(e,s)}},i.addTextureDic=function(t,e){this._textureIndex[e]=t},i.getTexture=function(t){var e=null,n=this._datas[this._textureIndex[t]];if(null==n)return null;var i=n[0],r=n[1][t];return r&&(e=i.getTexture(t),e||(e=i.createTexture(t,r.region.x,r.region.y,r.region.width,r.region.height))),e},i.dispose=function(){t.prototype.dispose.call(this),this._datas.length=0,this._datas=null,this._textureIndex=null},i.getRegion=function(t){for(var e=0,n=this._datas.length;n>e;e++){var i=this._datas[e],r=(i[0],i[1][t]);if(r)return r.region}return null},i.getFrame=function(t){for(var e=0,n=this._datas.length;n>e;e++){var i=this._datas[e],r=(i[0],i[1][t]);if(r)return r.frame}return null},i.parseSingleData=function(t){return dragonBones.DataParser.parseTextureAtlasData(t,this.scale)},e}(dragonBones.EgretTextureAtlas);egret.registerClass(EgretTextureAtlasMore,"EgretTextureAtlasMore");var LoadingUI=function(t){function e(){t.call(this),this.createView()}__extends(e,t);var n=(__define,e),i=n.prototype;return i.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},i.setProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);egret.registerClass(LoadingUI,"LoadingUI");var Main=function(t){function e(){t.call(this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var n=(__define,e),i=n.prototype;return i.onAddToStage=function(t){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),this.stage.registerImplementation("eui.IAssetAdapter",new AssetAdapter),this.stage.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),App.DeviceUtils.IsPC&&App.StageUtils.setScaleMode(egret.StageScaleMode.SHOW_ALL),this.initScene(),this.initModule(),App.SceneManager.runScene(SceneConsts.LOADING),this.loadResVersionComplate()},i.loadResVersionComplate=function(){App.ResourceUtils.addConfig("resource/default.res.json","resource/"),App.ResourceUtils.addConfig("resource/resource_core.json","resource/"),App.ResourceUtils.addConfig("resource/resource_ui.json","resource/"),App.ResourceUtils.addConfig("resource/resource_battle.json","resource/"),App.ResourceUtils.loadConfig(this.onConfigComplete,this)},i.onConfigComplete=function(){var t=new eui.Theme("resource/default.thm.json",this.stage);t.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this)},i.onThemeLoadComplete=function(){new CardMain},i.initScene=function(){App.SceneManager.register(SceneConsts.LOADING,new LoadingScene),App.SceneManager.register(SceneConsts.Login,new LoginScene),App.SceneManager.register(SceneConsts.Reg,new RegScene)},i.initModule=function(){App.ControllerManager.register(ControllerConst.Loading,new LoadingController),App.ControllerManager.register(ControllerConst.Login,new LoginController),App.ControllerManager.register(ControllerConst.Reg,new RegController)},e}(egret.DisplayObjectContainer);egret.registerClass(Main,"Main");var GuideMaskBackgroud=function(t){function e(){t.call(this),this._stageWidth=0,this._stageHeight=0,this._bgs=new Array,this.touchEnabled=!0}__extends(e,t);var n=(__define,e),i=n.prototype;return i.init=function(t,e){this._stageWidth=t,this._stageHeight=e},i.draw=function(t){this.cacheAsBitmap=!1,this._deductRec=t,this.removeAllChild();var e=Math.max(t.x,0),n=Math.max(t.y,0),i=Math.min(t.x+t.width,this._stageWidth),r=Math.min(t.y+t.height,this._stageHeight);this.addBg(0,0,this._stageWidth,n),this.addBg(0,n,e,t.height),this.addBg(i,n,this._stageWidth-i,t.height),this.addBg(0,r,this._stageWidth,this._stageHeight-r),this.width=this._stageWidth,this.height=this._stageHeight,this.cacheAsBitmap=!0},i.destroy=function(){this.removeChildren(),this._bgs=[]},i.removeAllChild=function(){for(;this.numChildren;){var t=this.removeChildAt(0);this._bgs.push(t)}},i.addBg=function(t,e,n,i){var r;this._bgs.length?(r=this._bgs.pop(),r.graphics.clear()):r=new egret.Shape,r.graphics.beginFill(0,.5),r.graphics.drawRect(t,e,n,i),r.graphics.endFill(),this.addChild(r)},i.hitTest=function(t,e,n){return this._deductRec&&this._deductRec.contains(t,e)?null:this},e}(egret.Sprite);egret.registerClass(GuideMaskBackgroud,"GuideMaskBackgroud");var GuideUtils=function(t){function e(){t.apply(this,arguments),this.configData={1:{1:{txt:"点击这里，去设置宠物出战",txtdir:1,handDir:1},2:{txt:"点击选择一个宠物出战",txtdir:3,handDir:1},3:{txt:"点击宠物出战",txtdir:3,handDir:1}},2:{1:{txt:"更多宠物，可以抽取获得哦！",txtdir:1,handDir:2},2:{txt:"点击抽取宠物",txtdir:1,handDir:1}},3:{1:{txt:"点击选择另一个宠物",txtdir:1,handDir:1},2:{txt:"点击宠物出战",txtdir:3,handDir:1}},4:{1:{txt:"点击查看宠物属性",txtdir:4,handDir:1},2:{txt:"点击宠物升级",txtdir:1,handDir:2},3:{txt:"点击选择升级材料",txtdir:3,handDir:1},4:{txt:"选择一个宠物或卡牌作为材料",txtdir:3,handDir:1},5:{txt:"选择材料后点击确定回到升级界面",txtdir:1,handDir:2},6:{txt:"点击完成升级",txtdir:1,handDir:2}},5:{1:{txt:"现在立刻享受\n炫酷的飞行吧",txtdir:1,handDir:2},2:{txt:"每天前3次购买免费",txtdir:1,handDir:1},3:{txt:"开始战斗吧",txtdir:1,handDir:2}},6:{1:{txt:"点击这里查看战机",txtdir:1,handDir:1},2:{txt:"点击升级战机，\n可以提高战力",txtdir:1,handDir:2}}},this.currPart=0,this.currStep=0}__extends(e,t);var n=(__define,e),i=n.prototype;return i.next=function(){null!=this.view&&null!=this.view.parent&&(this.currStep++,this.configData[this.currPart][this.currStep]||(this.currPart++,this.currStep=1),this.configData[this.currPart]||(this.currPart=0,this.currStep=0),this.hide())},i.show=function(t,e,n){this.currPart==e&&this.currStep==n&&(null==this.view&&(this.view=new GuideView),this.view.setData(t,this.configData[this.currPart][this.currStep]),egret.MainContext.instance.stage.addChild(this.view))},i.hide=function(){App.DisplayUtils.removeFromParent(this.view)},i.isShow=function(){return null!=this.view&&null!=this.view.parent},e}(BaseClass);egret.registerClass(GuideUtils,"GuideUtils");var GuideView=function(t){function e(){t.call(this),this._objRec=new egret.Rectangle,this._objGlobalPoint=new egret.Point,this._bg=new GuideMaskBackgroud,this.addChild(this._bg),this._maskPic=StarlingSwfUtils.createS9Image("s9_guide_mask"),this.addChild(this._maskPic),this._textBgPic=StarlingSwfUtils.createS9Image("s9_guide_txt"),AnchorUtil.setAnchorY(this._textBgPic,1),this.addChild(this._textBgPic),this._handPic=StarlingSwfUtils.createImage("img_hand"),AnchorUtil.setAnchorX(this._handPic,.5),this.addChild(this._handPic),this._txt=new egret.TextField,this._txt.size=26,this._txt.textColor=5723991,this._txt.lineSpacing=4,AnchorUtil.setAnchorY(this._txt,.5),this.addChild(this._txt),egret.MainContext.instance.stage.addEventListener(egret.Event.RESIZE,this.onResize,this)}__extends(e,t);var n=(__define,e),i=n.prototype;return i.onResize=function(){this.stage&&egret.setTimeout(this.refurbish,this,500)},i.refurbish=function(){this.setData(this._obj,this._data)},i.setData=function(t,e){if(null!=t){this._obj=t,this._data=e,this._obj.localToGlobal(0,0,this._objGlobalPoint),this._obj.getBounds(this._objRec),this._objGlobalPoint.x=Math.ceil(this._objGlobalPoint.x),this._objGlobalPoint.y=Math.ceil(this._objGlobalPoint.y);var n=15,i=15;this._objRec.x=this._objGlobalPoint.x-n,this._objRec.y=this._objGlobalPoint.y-i,this._objRec.width+=2*n,this._objRec.height+=2*i,this._bg.init(egret.MainContext.instance.stage.stageWidth,egret.MainContext.instance.stage.stageHeight),this._bg.draw(this._objRec),this._maskPic.cacheAsBitmap=!1,this._maskPic.x=this._objRec.x,this._maskPic.y=this._objRec.y,this._maskPic.width=this._objRec.width,this._maskPic.height=this._objRec.height,this._maskPic.cacheAsBitmap=!0,1==this._data.handDir?(this._handPic.scaleY=1,this._handPic.y=this._objRec.y+this._objRec.height-20):2==this._data.handDir&&(this._handPic.scaleY=-1,this._handPic.y=this._objRec.y+20),this._handPic.x=this._objRec.x+.5*this._objRec.width,this._txt.width=0/0,this._txt.height=0/0,this._txt.text=this._data.txt,this._txt.width>320&&(this._txt.text="",this._txt.width=320,this._txt.text=this._data.txt);var r=15;this._textBgPic.cacheAsBitmap=!1,this._textBgPic.width=this._txt.width+2*r+35,this._textBgPic.height=114,1==this._data.txtdir?(this._textBgPic.scaleX=-1,this._textBgPic.scaleY=1,this._textBgPic.x=this._objRec.x):2==this._data.txtdir?(this._textBgPic.scaleX=-1,this._textBgPic.scaleY=-1,this._textBgPic.x=this._objRec.x):3==this._data.txtdir?(this._textBgPic.scaleX=1,this._textBgPic.scaleY=1,this._textBgPic.x=this._objRec.x+this._objRec.width):4==this._data.txtdir&&(this._textBgPic.scaleX=1,this._textBgPic.scaleY=-1,this._textBgPic.x=this._objRec.x+this._objRec.width),this.checkTextBgX(),this._textBgPic.y=this._objRec.y+.5*this._objRec.height,this._txt.x=this._textBgPic.x-(-1==this._textBgPic.scaleX?this._textBgPic.width:-35)+r,this._txt.y=this._textBgPic.y-this._textBgPic.scaleY*this._textBgPic.height*.5,this._textBgPic.cacheAsBitmap=!0}},i.checkTextBgX=function(){if(1==this._textBgPic.scaleX){var t=egret.MainContext.instance.stage.stageWidth;this._textBgPic.x+this._textBgPic.width>t&&(this._textBgPic.x=t-this._textBgPic.width)}else-1==this._textBgPic.scaleX&&this._textBgPic.x-this._textBgPic.width<0&&(this._textBgPic.x=this._textBgPic.width)},e}(egret.Sprite);egret.registerClass(GuideView,"GuideView");var EasyLoading=function(t){function e(){t.call(this),this.content=null,this.speed=.6,this.init()}__extends(e,t);var n=(__define,e),i=n.prototype;return i.init=function(){this.averageUtils=new AverageUtils,this.content=new egret.Sprite,this.content.graphics.beginFill(0,.2),this.content.graphics.drawRect(0,0,App.StageUtils.getWidth(),App.StageUtils.getHeight()),this.content.graphics.endFill(),this.content.touchEnabled=!0,this.uiImageContainer=new egret.DisplayObjectContainer,this.uiImageContainer.x=.5*this.content.width,this.uiImageContainer.y=.5*this.content.height,this.content.addChild(this.uiImageContainer),RES.getResByUrl("resource/assets/load_Reel.png",function(t){var e=new egret.Bitmap;e.texture=t,e.x=.5*-e.width,e.y=.5*-e.height,this.uiImageContainer.addChild(e)},this,RES.ResourceItem.TYPE_IMAGE)},i.showLoading=function(){App.StageUtils.getStage().addChild(this.content),App.TimerManager.doFrame(1,0,this.enterFrame,this)},i.hideLoading=function(){this.content&&this.content.parent&&(App.StageUtils.getStage().removeChild(this.content),this.uiImageContainer.rotation=0),App.TimerManager.remove(this.enterFrame,this)},i.enterFrame=function(t){this.averageUtils.push(this.speed*t),this.uiImageContainer.rotation+=this.averageUtils.getValue()},e}(BaseClass);egret.registerClass(EasyLoading,"EasyLoading");var BaseController=function(){function t(){this._messages={}}var e=(__define,t),n=e.prototype;return n.registerFunc=function(t,e,n){this._messages[t]=[e,n]},n.applyFunc=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var i=this._messages[t];return i?i[0].apply(i[1],e):(Log.trace("消息"+t+"不存在侦听"),null)},n.applyControllerFunc=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return App.ControllerManager.applyFunc.apply(App.ControllerManager,arguments)},n.setModel=function(t){this._model=t},n.getModel=function(){return this._model},n.getControllerModel=function(t){return App.ControllerManager.getControllerModel(t)},t}();egret.registerClass(BaseController,"BaseController");var ControllerManager=function(t){function e(){t.call(this),this._modules={}}__extends(e,t);var n=(__define,e),i=n.prototype;return i.clear=function(){this._modules={}},i.register=function(t,e){this.isExists(t)||(this._modules[t]=e)},i.unregister=function(t){this.isExists(t)&&(this._modules[t]=null,delete this._modules[t])},i.isExists=function(t){return null!=this._modules[t]},i.applyFunc=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var r=this._modules[t];if(r){for(var s=[],a=1;a<arguments.length;a++)s[a-1]=arguments[a];return r.applyFunc.apply(r,s)}return Log.trace("模块"+t+"不存在"),null},i.getControllerModel=function(t){var e=this._modules[t];return e?e.getModel():null},e}(BaseClass);egret.registerClass(ControllerManager,"ControllerManager");var BaseModel=function(){function t(t){this._controller=t,this._controller.setModel(this)}var e=(__define,t);e.prototype;return t}();egret.registerClass(BaseModel,"BaseModel");var BaseProxy=function(){function t(t){this._controller=t}var e=(__define,t),n=e.prototype;return n.applyFunc=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return this._controller.applyFunc.apply(this._controller,arguments)},n.applyControllerFunc=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return this._controller.applyControllerFunc.apply(this._controller,arguments)},n.receiveServerMsg=function(t,e,n){App.MessageCenter.addListener(t,e,n)},n.receiveServerMsgOnce=function(t,e,n){var i=function(r){this.removeServerMsg(t,i,this),e.apply(n,r)};this.receiveServerMsg(t,i,this)},n.receiveServerHttpUpdateMsg=function(t,e,n){this.receiveServerMsg(t+"_HttpUpdate",e,n)},n.receiveServerHttpUpdateMsgOnce=function(t,e,n){this.receiveServerMsgOnce(t+"_HttpUpdate",e,n)},n.removeServerMsg=function(t,e,n){App.MessageCenter.removeListener(t,e,n)},n.removeServerHttpUpdateMsg=function(t,e,n){this.removeServerMsg(t+"_HttpUpdate",e,n)},n.sendSocketMsg=function(t){App.Socket.send(t)},n.sendHttpMsg=function(t,e){void 0===e&&(e=null),App.Http.send(t,this.getURLVariables(t,e))},n.getURLVariables=function(t,e){var n=t.split("."),i={};i.mod=n[0],i["do"]=n[1],null!=e&&(i.p=e);var r=JSON.stringify(i),s=new egret.URLVariables("data="+r+"&h="+App.ProxyUserFlag);return s},t}();egret.registerClass(BaseProxy,"BaseProxy");var BaseEuiView=function(t){function e(e,n){t.call(this),this._resources=null,this._controller=e,this._myParent=n,this._isInit=!1,this.percentHeight=100,this.percentWidth=100}__extends(e,t);var n=__define,i=e,r=i.prototype;return n(r,"myParent",function(){return this._myParent}),r.setResources=function(t){this._resources=t},r.isInit=function(){return this._isInit},r.applyFunc=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return this._controller.applyFunc.apply(this._controller,arguments)},r.applyControllerFunc=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return this._controller.applyControllerFunc.apply(this._controller,arguments)},r.isShow=function(){return null!=this.stage&&this.visible},r.addToParent=function(){this._myParent.addChild(this)},r.removeFromParent=function(){App.DisplayUtils.removeFromParent(this)},r.initUI=function(){this._isInit=!0},r.initData=function(){},r.destroy=function(){this._controller=null,this._myParent=null,this._resources=null},r.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e]},r.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e]},r.loadResource=function(t,e){this._resources&&this._resources.length>0?(App.ResourceUtils.loadResource(this._resources,[],t,null,this),this.addEventListener(eui.UIEvent.CREATION_COMPLETE,e,this)):(t(),e())},r.setVisible=function(t){this.visible=t},e}(eui.Component);egret.registerClass(BaseEuiView,"BaseEuiView",["IBaseView"]);var BaseSpriteView=function(t){function e(e,n){t.call(this),this._resources=null,this._controller=e,this._myParent=n,this._isInit=!1,App.StageUtils.getStage().addEventListener(egret.Event.RESIZE,this.onResize,this)}__extends(e,t);var n=__define,i=e,r=i.prototype;return r.setResources=function(t){this._resources=t},n(r,"myParent",function(){return this._myParent}),r.isInit=function(){return this._isInit},r.applyFunc=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return this._controller.applyFunc.apply(this._controller,arguments)},r.applyControllerFunc=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return this._controller.applyControllerFunc.apply(this._controller,arguments)},r.isShow=function(){return null!=this.stage&&this.visible},r.addToParent=function(){this._myParent.addChild(this)},r.removeFromParent=function(){App.DisplayUtils.removeFromParent(this)},r.initUI=function(){this._isInit=!0},r.initData=function(){},r.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e]},r.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e]},r.destroy=function(){this._controller=null,this._myParent=null,this._resources=null},r.onResize=function(){},r.loadResource=function(t,e){this._resources&&this._resources.length>0?App.ResourceUtils.loadResource(this._resources,[],function(){t(),e()},null,this):(t(),e())},r.setVisible=function(t){this.visible=t},e}(egret.DisplayObjectContainer);egret.registerClass(BaseSpriteView,"BaseSpriteView",["IBaseView"]);var ViewManager=function(t){function e(){t.call(this),this._views={},this._opens=[]}__extends(e,t);var n=(__define,e),i=n.prototype;return i.clear=function(){this.closeAll(),this._views={}},i.register=function(t,e){null!=e&&(this._views[t]||(this._views[t]=e))
},i.unregister=function(t){this._views[t]&&(this._views[t]=null,delete this._views[t])},i.destroy=function(t,e){void 0===e&&(e=null);var n=this.getView(t);n&&(this.unregister(t),n.destroy(),n=null),this.register(t,e)},i.open=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var i=this.getView(t);return null==i?void Log.trace("UI_"+t+"不存在"):i.isShow()?(i.open.apply(i,e),i):(i.isInit()?(i.addToParent(),i.open.apply(i,e)):(App.EasyLoading.showLoading(),i.loadResource(function(){i.addToParent(),i.setVisible(!1)}.bind(this),function(){i.initUI(),i.initData(),i.open.apply(i,e),i.setVisible(!0),App.EasyLoading.hideLoading()}.bind(this))),this._opens.push(t),i)},i.close=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(this.isShow(t)){var i=this.getView(t);if(null!=i){var r=this._opens.indexOf(t);t>=0&&this._opens.splice(r,1),i.removeFromParent(),i.close.apply(i,e)}}},i.closeView=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var i=Object.keys(this._views),r=0,s=i.length;s>r;r++){var a=parseInt(i[r]);if(this._views[a]==t)return void this.close(a,e)}},i.getView=function(t){return this._views[t]},i.closeAll=function(){for(;this._opens.length;)this.close(this._opens[0])},i.currOpenNum=function(){return this._opens.length},i.isShow=function(t){return-1!=this._opens.indexOf(t)},e}(BaseClass);egret.registerClass(ViewManager,"ViewManager");var CardMain=function(){function t(){var t="preload",e=["preload_core"];App.ResourceUtils.loadGroups(t,e,this.onResourceLoadComplete,this.onResourceLoadProgress,this)}var e=(__define,t),n=e.prototype;return n.onResourceLoadComplete=function(){this.initModule(),App.Init(),GameManager.getInstance().connectServer(),App.SceneManager.runScene(SceneConsts.Login),App.SoundManager.setBgOn(!0),App.SoundManager.setEffectOn(!0)},n.onResourceLoadProgress=function(t,e){App.ControllerManager.applyFunc(ControllerConst.Loading,LoadingConst.SetProgress,t,e)},n.initBattleDragonBones=function(){for(var t=["zhujue1","zhujue2","guaiwu001","jineng1","jineng2","guaiwu002","guaiwu002_effect","guaiwu003","guaiwu003_effect"],e=0,n=t.length;n>e;e++){var i=t[e],r=RES.getRes(i+"_skeleton_json"),s=RES.getRes(i+"_texture_png"),a=RES.getRes(i+"_texture_json");App.DragonBonesFactory.initArmatureFile(r,s,a)}},n.initModule=function(){},t}();egret.registerClass(CardMain,"CardMain");var ControllerConst;!function(t){t[t.Loading=1e4]="Loading",t[t.Login=10001]="Login",t[t.Reg=10002]="Reg",t[t.Home=10003]="Home",t[t.Friend=10004]="Friend",t[t.Shop=10005]="Shop",t[t.Warehouse=10006]="Warehouse",t[t.Factory=10007]="Factory",t[t.Task=10008]="Task",t[t.Mail=10009]="Mail",t[t.Game=10010]="Game"}(ControllerConst||(ControllerConst={}));var HttpConst=function(){function t(){}var e=(__define,t);e.prototype;return t.USER_LOGIN="User.login",t}();egret.registerClass(HttpConst,"HttpConst");var SceneConsts;!function(t){t[t.Game=1]="Game",t[t.UI=2]="UI",t[t.LOADING=3]="LOADING",t[t.Login=4]="Login",t[t.Reg=5]="Reg"}(SceneConsts||(SceneConsts={}));var ViewConst;!function(t){t[t.Loading=1e4]="Loading",t[t.Login=10001]="Login",t[t.Reg=10002]="Reg",t[t.Home=10003]="Home",t[t.Friend=10004]="Friend",t[t.Shop=10005]="Shop",t[t.Warehouse=10006]="Warehouse",t[t.Factory=10007]="Factory",t[t.Task=10008]="Task",t[t.Daily=10009]="Daily",t[t.Mail=10010]="Mail",t[t.Game=2e4]="Game",t[t.GameUI=20001]="GameUI"}(ViewConst||(ViewConst={}));var GameManager=function(){function t(){if(t._singleton)throw new Error("")}var e=(__define,t),n=e.prototype;return t.getInstance=function(){return t._instance||(t._singleton=!1,t._instance=new t,t._singleton=!0),t._instance},n.connectServer=function(){App.Socket.connect(),App.MessageCenter.addListener(SocketConst.SOCKET_CONNECT,function(){Log.trace("与服务器连接上")},this),App.MessageCenter.addListener(SocketConst.SOCKET_RECONNECT,function(){Log.trace("与服务器重新连接上")},this),App.MessageCenter.addListener(SocketConst.SOCKET_START_RECONNECT,function(){Log.trace("开始与服务器重新连接")},this),App.MessageCenter.addListener(SocketConst.SOCKET_CLOSE,function(){Log.trace("与服务器断开连接")},this),App.MessageCenter.addListener(SocketConst.SOCKET_NOCONNECT,function(){Log.trace("服务器连接不上")},this)},t._singleton=!0,t}();egret.registerClass(GameManager,"GameManager");var LoadingConst=function(){function t(){}var e=(__define,t);e.prototype;return t.SetProgress=10001,t}();egret.registerClass(LoadingConst,"LoadingConst");var LoadingController=function(t){function e(){t.call(this),this.loadingView=new LoadingView(this,LayerManager.UI_Main),App.ViewManager.register(ViewConst.Loading,this.loadingView),this.registerFunc(LoadingConst.SetProgress,this.setProgress,this)}__extends(e,t);var n=(__define,e),i=n.prototype;return i.setProgress=function(t,e){this.loadingView.setProgress(t,e)},e}(BaseController);egret.registerClass(LoadingController,"LoadingController");var LoadingView=function(t){function e(e,n){t.call(this,e,n),this.skinName="resource/skins/LoadingUISkin.exml"}__extends(e,t);var n=(__define,e),i=n.prototype;return i.setProgress=function(t,e){this.txtMsg.text="资源加载中..."+t+"/"+e},e}(BaseEuiView);egret.registerClass(LoadingView,"LoadingView");var LoginController=function(t){function e(){t.call(this),this.loginView=new LoginView(this,LayerManager.UI_Main),App.ViewManager.register(ViewConst.Login,this.loginView)}__extends(e,t);var n=(__define,e);n.prototype;return e}(BaseController);egret.registerClass(LoginController,"LoginController");var LoginView=function(t){function e(e,n){t.call(this,e,n),this.pomelo=new PomeloForEgret.Pomelo,this.skinName="resource/skins/LoginUISkin.exml"}__extends(e,t);var n=(__define,e),i=n.prototype;return i.initUI=function(){t.prototype.initUI.call(this),App.MessageCenter.addListener("10005",function(t){Log.trace("收到服务器消息:",t),1==t.flag?Log.trace("yes"):2==t.flag?Log.trace("该用户不存在"):Log.trace("no")},this),this.btnLogin.addEventListener(egret.TouchEvent.TOUCH_TAP,this.loginClickHandler,this)},i.loginClickHandler=function(t){this.testConnection()},i.testConnection=function(){var t="127.0.0.1",e="3010";this.pomelo.on(PomeloForEgret.Pomelo.EVENT_IO_ERROR,function(t){console.error("error",t)}),this.pomelo.on(PomeloForEgret.Pomelo.EVENT_CLOSE,function(t){console.error("close",t)}),this.pomelo.on(PomeloForEgret.Pomelo.EVENT_HEART_BEAT_TIMEOUT,function(t){console.error("heart beat timeout",t)}),this.pomelo.on(PomeloForEgret.Pomelo.EVENT_KICK,function(t){console.error("kick",t)});var n=this.pomelo;this.pomelo.init({host:t,port:e},function(){n.request("connector.entryHandler.entry","hello world",function(t){console.log("request",t)}),n.request("connector.entryHandler.publish","hello world",function(t){console.log("request",t)}),n.request("connector.entryHandler.subscribe","hello world",function(t){console.log("request",t)})})},e}(BaseEuiView);egret.registerClass(LoginView,"LoginView");var RegController=function(t){function e(){t.call(this),this.regView=new RegView(this,LayerManager.UI_Main),App.ViewManager.register(ViewConst.Reg,this.regView)}__extends(e,t);var n=(__define,e);n.prototype;return e}(BaseController);egret.registerClass(RegController,"RegController");var RegView=function(t){function e(e,n){t.call(this,e,n),this.skinName="resource/skins/RegUISkin.exml"}__extends(e,t);var n=(__define,e),i=n.prototype;return i.initUI=function(){t.prototype.initUI.call(this),App.MessageCenter.addListener("10015",function(t){Log.trace("收到服务器消息:",t),1==t.flag?Log.trace("yes"):2==t.flag?Log.trace("已经被注册过"):Log.trace("no")},this),this.btnReg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.regClickHandler,this)},i.regClickHandler=function(t){var e={};e.key="u_reg_c2s",e.body={account:this.txtName.text,pass:this.txtPass.text},App.Socket.send(e)},e}(BaseEuiView);egret.registerClass(RegView,"RegView");var BaseScene=function(){function t(){this._layers=new Array}var e=(__define,t),n=e.prototype;return n.onEnter=function(){},n.onExit=function(){App.ViewManager.closeAll(),this.removeAllLayer()},n.addLayer=function(t){t instanceof BaseSpriteLayer?(App.StageUtils.getStage().addChild(t),this._layers.push(t)):t instanceof BaseEuiLayer&&(App.StageUtils.getUIStage().addChild(t),this._layers.push(t))},n.addLayerAt=function(t,e){t instanceof BaseSpriteLayer?(App.StageUtils.getStage().addChildAt(t,e),this._layers.push(t)):t instanceof BaseEuiLayer&&(App.StageUtils.getUIStage().addChildAt(t,e),this._layers.push(t))},n.removeLayer=function(t){t instanceof BaseSpriteLayer?(App.StageUtils.getStage().removeChild(t),this._layers.splice(this._layers.indexOf(t),1)):t instanceof BaseEuiLayer&&(App.StageUtils.getUIStage().removeChild(t),this._layers.splice(this._layers.indexOf(t),1))},n.layerRemoveAllChild=function(t){t instanceof BaseSpriteLayer?t.removeChildren():t instanceof BaseEuiLayer&&t.removeChildren()},n.removeAllLayer=function(){for(;this._layers.length;){var t=this._layers[0];this.layerRemoveAllChild(t),this.removeLayer(t)}},t}();egret.registerClass(BaseScene,"BaseScene");var GameScene=function(t){function e(){t.call(this)}__extends(e,t);var n=(__define,e),i=n.prototype;return i.onEnter=function(){t.prototype.onEnter.call(this),this.addLayerAt(LayerManager.Game_Main,0),App.ViewManager.open(ViewConst.Game),App.ViewManager.open(ViewConst.GameUI),App.SoundManager.playBg("sound_bg")},i.onExit=function(){t.prototype.onExit.call(this)},e}(BaseScene);egret.registerClass(GameScene,"GameScene");var BaseSpriteLayer=function(t){function e(){t.call(this),this.touchEnabled=!1}__extends(e,t);var n=(__define,e);n.prototype;return e}(egret.DisplayObjectContainer);egret.registerClass(BaseSpriteLayer,"BaseSpriteLayer");var BaseEuiLayer=function(t){function e(){t.call(this),this.percentWidth=100,this.percentHeight=100,this.touchEnabled=!1}__extends(e,t);var n=(__define,e);n.prototype;return e}(eui.Group);egret.registerClass(BaseEuiLayer,"BaseEuiLayer");var LayerManager=function(){function t(){}var e=(__define,t);e.prototype;return t.Game_Bg=new BaseSpriteLayer,t.Game_Main=new BaseSpriteLayer,t.UI_Main=new BaseEuiLayer,t.UI_Popup=new BaseEuiLayer,t.UI_Message=new BaseEuiLayer,t.UI_Tips=new BaseEuiLayer,t}();egret.registerClass(LayerManager,"LayerManager");var LoadingScene=function(t){function e(){t.call(this)}__extends(e,t);var n=(__define,e),i=n.prototype;return i.onEnter=function(){t.prototype.onEnter.call(this),this.addLayer(LayerManager.UI_Main),App.ViewManager.open(ViewConst.Loading)},i.onExit=function(){t.prototype.onExit.call(this)},e}(BaseScene);egret.registerClass(LoadingScene,"LoadingScene");var LoginScene=function(t){function e(){t.call(this)}__extends(e,t);var n=(__define,e),i=n.prototype;return i.onEnter=function(){t.prototype.onEnter.call(this),this.addLayer(LayerManager.UI_Main),App.ViewManager.open(ViewConst.Login)},i.onExit=function(){t.prototype.onExit.call(this)},e}(BaseScene);egret.registerClass(LoginScene,"LoginScene");var RegScene=function(t){function e(){t.call(this)}__extends(e,t);var n=(__define,e),i=n.prototype;return i.onEnter=function(){t.prototype.onEnter.call(this),this.addLayer(LayerManager.UI_Main),App.ViewManager.open(ViewConst.Reg)},i.onExit=function(){t.prototype.onExit.call(this)},e}(BaseScene);egret.registerClass(RegScene,"RegScene");var UIScene=function(t){function e(){t.call(this)}__extends(e,t);var n=(__define,e),i=n.prototype;return i.onEnter=function(){t.prototype.onEnter.call(this),this.addLayer(LayerManager.UI_Main),this.addLayer(LayerManager.UI_Popup),this.addLayer(LayerManager.UI_Message),this.addLayer(LayerManager.UI_Tips);var e=new eui.Rect;e.fillColor=7911743,e.percentHeight=100,e.percentWidth=100,LayerManager.UI_Main.addChild(e),App.ViewManager.open(ViewConst.Home),App.SoundManager.playBg("sound_bg")},i.onExit=function(){t.prototype.onExit.call(this)},e}(BaseScene);egret.registerClass(UIScene,"UIScene");var DynamicChange=function(){function t(){this._dataCache=[],this._pUpdate=new ProxyUpdate(this._dataCache)}var e=__define,n=t,i=n.prototype;return e(i,"pUpdate",function(){return this._pUpdate}),i.getCacheData=function(t){return this._dataCache[t]?this._dataCache[t]:null},i.clearCache=function(){for(var t=Object.keys(this._dataCache),e=0,n=t.length;n>e;e++){var i=t[e];this._dataCache[i]=null,delete this._dataCache[i]}},i.getCacheKeyInfos=function(){for(var t=[],e=Object.keys(this._dataCache),n=0,i=e.length;i>n;n++){var r=e[n],s=this._dataCache[r];t.push(s)}return t},i.isCache=function(t){return this._dataCache[t]},t}();egret.registerClass(DynamicChange,"DynamicChange");var ProxyUpdate=function(){function t(t){this._cache=t}var e=(__define,t),n=e.prototype;return n.isArray=function(t){return t instanceof Array},n.isObject=function(t){return t.indexOf("object")>-1},n.isNormal=function(t){var e=t.indexOf("@")>-1,n=t.indexOf(".")>-1,i=t.indexOf("_")>-1;return!e&&!n&&!i},n.isAddToArray=function(t){return"@a"==t},n.isRemoveToArray=function(t){var e=t.split("_");return e.length<=3&&"@d"==e[0]},n.isFilter=function(t){var e=t.split("_");return"@f"==e[0]},n.isNumeric=function(t){return parseFloat(t).toString()==t.toString()},n._updateObject=function(t,e,n){var i=t.split(".");"@a"==i[0]||"@s"==i[0]?n[i[1]]=e:"@d"==i[0]&&delete n[i[1]]},n._getFilterObject=function(t,e){if(e){var n=t.split("_");if(3==n.length&&"@f"==n[0]&&this.isArray(e))for(var i=n[1],r=n[2],s=0;s<e.length;s++){var a=e[s];if(3==n.length&&this.isObject(a.toString())){var o=a[i];if(o&&("@"==r[0]&&(r=r.replace("@","")),r==o))return a}}}return null},n._addObjectToArray=function(t,e){if(this.isArray(e))for(var n=0;n<e.length;n++)t.push(e[n]);else t.push(e)},n._removeObjectFromArray=function(t,e,n){var i=e.split("_");if(i.length<=3&&"@d"==i[0]&&this.isArray(t))for(var r=t.length,s=r-1;s>=0;s--){var a=t[s];if(3==i.length){if(a.hasOwnProperty(i[1])){var o=i[2];"@"==o[0]&&(o=o.replace("@","")),o==a[i[1]]&&t.splice(s,1)}}else 2==i.length&&a.hasOwnProperty(i[1])?n==a[i[1]]&&t.splice(s,1):1==i.length&&n==a&&t.splice(s,1)}},n.update=function(t,e){if(this._cache[t]=e,e.hasOwnProperty("c"))for(var n=e.c,i=Object.keys(n),r=0,s=i.length;s>r;r++){var a=i[r];this._cache[a]&&(this._update(this._cache[a],n[a]),App.MessageCenter.dispatch(a+"_HttpUpdate"))}},n._update=function(t,e){if(t&&e&&this.isObject(e.toString()))for(var n=Object.keys(e),i=0,r=n.length;r>i;i++){var s=n[i],a=e[s];if(this.isNormal(s)&&this.isObject(a.toString()))t.hasOwnProperty(s)&&this._update(t[s],a);else if(this.isNormal(s)&&this.isNumeric(a)){var o=t[s];t[s]=o+a}else if(this.isNormal(s))t[s]=a;else if(this.isAddToArray(s))this._addObjectToArray(t,a);else if(this.isRemoveToArray(s))this._removeObjectFromArray(t,s,a);else if(this.isFilter(s)){var h=this._getFilterObject(s,t);h&&this._update(h,a)}else this._updateObject(s,a,t)}},t}();egret.registerClass(ProxyUpdate,"ProxyUpdate");var Http=function(t){function e(){t.call(this),this._data=new DynamicChange,this._cache=[],this._request=new egret.URLRequest,this._request.method=egret.URLRequestMethod.POST,this._urlLoader=new egret.URLLoader,this._urlLoader.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onError,this)}__extends(e,t);var n=__define,i=e,r=i.prototype;return r.initServer=function(t){this._serverUrl=t},n(r,"Data",function(){return this._data}),r.onError=function(t){this.nextPost()},r.send=function(t,e){this._cache.push([t,e]),this.post()},r.post=function(){if(!this._isRequesting&&0!=this._cache.length){var t=this._cache.shift(),e=t[0],n=t[1];this._type=e,this._request.url=this._serverUrl,this._request.data=n,this._urlLoader.addEventListener(egret.Event.COMPLETE,this.onLoaderComplete,this),this._urlLoader.load(this._request),this._isRequesting=!0}},r.onLoaderComplete=function(t){this._urlLoader.removeEventListener(egret.Event.COMPLETE,this.onLoaderComplete,this);var e=JSON.parse(this._urlLoader.data);e.hasOwnProperty("s")&&0!=e.s?Log.trace("Http错误:"+e.s):(this._data.pUpdate.update(this._type,e),App.MessageCenter.dispatch(this._type,e)),this.nextPost()},r.nextPost=function(){this._isRequesting=!1,this.post()},e}(BaseClass);egret.registerClass(Http,"Http");var ByteArrayMsg=function(){function t(){this._msgBuffer=new egret.ByteArray}var e=(__define,t),n=e.prototype;return n.receive=function(t){t.readBytes(this._msgBuffer);var e=this.decode(this._msgBuffer);e&&App.MessageCenter.dispatch(e.msgId,e.body),0==this._msgBuffer.bytesAvailable&&this._msgBuffer.clear()},n.send=function(t,e){var n=this.encode(e);n&&(n.position=0,t.writeBytes(n,0,n.bytesAvailable))},n.decode=function(t){return Log.trace("decode需要子类重写，根据项目的协议结构解析"),null},n.encode=function(t){return Log.trace("encode需要子类重写，根据项目的协议结构解析"),null},t}();egret.registerClass(ByteArrayMsg,"ByteArrayMsg",["BaseMsg"]);var ByteArrayMsgByProtobuf=function(t){function e(){t.call(this),this.msgClass=null,this.protoConfig=null,this.protoConfigSymmetry=null,this.msgClass={},this.protoConfig=App.ProtoConfig,this.protoConfigSymmetry={};for(var e=Object.keys(this.protoConfig),n=0,i=e.length;i>n;n++){var r=e[n],s=this.protoConfig[r];this.protoConfigSymmetry[s]=r}}__extends(e,t);var n=(__define,e),i=n.prototype;return i.getMsgClass=function(t){var e=this.msgClass[t];return null==e&&(e=App.ProtoFile.build(t),this.msgClass[t]=e),e},i.getMsgID=function(t){return this.protoConfigSymmetry[t]},i.getMsgKey=function(t){return this.protoConfig[t]},i.decode=function(t){var e=t.readShort(),n=t.readShort();if(t.bytesAvailable>=n){var i=new egret.ByteArray;t.readBytes(i,0,n);var r={};return r.msgId=e,r.key=this.getMsgKey(e),App.DebugUtils.start("Protobuf Decode"),r.body=this.getMsgClass(r.key).decode(i.buffer),App.DebugUtils.stop("Protobuf Decode"),Log.trace("收到数据：","["+e+" "+r.key+"]",r.body),r}return null},i.encode=function(t){var e=this.getMsgID(t.key),n=new(this.getMsgClass(t.key))(t.body);App.DebugUtils.start("Protobuf Encode");var i=new egret.ByteArray(n.toArrayBuffer());App.DebugUtils.stop("Protobuf Encode"),Log.trace("发送数据：","["+e+" "+t.key+"]",t.body);var r=new egret.ByteArray;return r.writeShort(e),r.writeBytes(i),r},e}(ByteArrayMsg);egret.registerClass(ByteArrayMsgByProtobuf,"ByteArrayMsgByProtobuf");var PomeloForEgret;!function(t){var e=function(){function t(){this.JS_WS_CLIENT_TYPE="js-websocket",this.JS_WS_CLIENT_VERSION="0.0.5",this.RES_OK=200,this.RES_FAIL=500,this.RES_OLD_CLIENT=501,this.socket=null,this.callbacks={},this.handlers={},this.routeMap={},this.heartbeatInterval=0,this.heartbeatTimeout=0,this.nextHeartbeatTimeout=0,this.gapThreshold=100,this.heartbeatId=null,this.heartbeatTimeoutId=null,this.handshakeCallback=null,this.initCallback=null,this._callbacks={},this.reqId=0,console.group||(console.group=console.log,console.groupEnd=function(){console.log("----")},console.info=console.log,console.warn=console.log,console.error=console.log),this._message=new i,this._package=new n,this.socket=null,this.callbacks={},this.handlers={},this.routeMap={},this.heartbeatInterval=0,this.heartbeatTimeout=0,this.nextHeartbeatTimeout=0,this.gapThreshold=100,this.heartbeatId=null,this.heartbeatTimeoutId=null,this.handshakeCallback=null,this.handshakeBuffer={sys:{type:this.JS_WS_CLIENT_TYPE,version:this.JS_WS_CLIENT_VERSION},user:{}},this.initCallback=null,this.reqId=0,this.handlers[n.TYPE_HANDSHAKE]=this.handshake,this.handlers[n.TYPE_HEARTBEAT]=this.heartbeat,this.handlers[n.TYPE_DATA]=this.onData,this.handlers[n.TYPE_KICK]=this.onKick}var e=(__define,t),o=e.prototype;return o.init=function(t,e){console.log("init",t),this.initCallback=e;var n=t.host,i=t.port;this.handshakeBuffer.user=t.user,this.handshakeCallback=t.handshakeCallback,this.initWebSocket(n,i,e)},o.initWebSocket=function(t,e,n){console.log("[Pomelo] connect to:",t,e),this.socket=new egret.WebSocket,this.socket.type=egret.WebSocket.TYPE_BINARY,this.socket.addEventListener(egret.Event.CONNECT,this.onConnect,this),this.socket.addEventListener(egret.Event.CLOSE,this.onClose,this),this.socket.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onIOError,this),this.socket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onMessage,this),this.socket.connect(t,e)},o.on=function(t,e){(this._callbacks[t]=this._callbacks[t]||[]).push(e)},o.request=function(e,n,i){if(2===arguments.length&&"function"==typeof n?(i=n,n={}):n=n||{},e=e||n.route){this.reqId++,this.reqId>127&&(this.reqId=1);var r=this.reqId;t.DEBUG&&(console.group("REQUEST:"),console.info("Route:",e),console.log("Id:",r),console.log("Param:",n),console.groupEnd()),this.sendMessage(r,e,n),this.callbacks[r]=i,this.routeMap[r]=e}},o.notify=function(t,e){this.sendMessage(0,t,e)},o.onMessage=function(t){var e=new egret.ByteArray;this.socket.readBytes(e),this.processPackage(this._package.decode(e))},o.sendMessage=function(t,e,i){var r;r=this._message.encode(t,e,i),r=this._package.encode(n.TYPE_DATA,r),this.send(r)},o.onConnect=function(t){console.log("[Pomelo] connect success",t),this.socket.writeBytes(this._package.encode(n.TYPE_HANDSHAKE,r.strencode(JSON.stringify(this.handshakeBuffer)))),this.socket.flush()},o.onClose=function(e){console.error("[Pomelo] connect close:",e),this.emit(t.EVENT_CLOSE,e)},o.onIOError=function(e){this.emit(t.EVENT_IO_ERROR,e),console.error("socket error: ",e)},o.onKick=function(e){this.emit(t.EVENT_KICK,e)},o.onData=function(t){var e=this._message.decode(t);e.id>0&&(e.route=this.routeMap[e.id],delete this.routeMap[e.id],!e.route)||this.processMessage(e)},o.processMessage=function(e){if(!e.id)return t.DEBUG&&(console.group("EVENT:"),console.info("Route:",e.route),console.info("Msg:",e.body),console.groupEnd()),void this.emit(e.route,e.body);t.DEBUG&&(console.group("RESPONSE:"),console.info("Id:",e.id),console.info("Msg:",e.body),console.groupEnd());var n=this.callbacks[e.id];if(delete this.callbacks[e.id],"function"==typeof n){if(e.body&&500==e.body.code){var i={code:500,desc:"服务器内部错误",key:"INTERNAL_ERROR"};e.body.error=i}n(e.body)}},o.heartbeat=function(t){if(this.heartbeatInterval){var e=this._package.encode(n.TYPE_HEARTBEAT);if(this.heartbeatTimeoutId&&(egret.clearTimeout(this.heartbeatTimeoutId),this.heartbeatTimeoutId=null),!this.heartbeatId){var i=this;i.heartbeatId=egret.setTimeout(function(){i.heartbeatId=null,i.send(e),i.nextHeartbeatTimeout=Date.now()+i.heartbeatTimeout,i.heartbeatTimeoutId=egret.setTimeout(i.heartbeatTimeoutCb.bind(i,t),i,i.heartbeatTimeout)},i,i.heartbeatInterval)}}},o.heartbeatTimeoutCb=function(e){var n=this.nextHeartbeatTimeout-Date.now();n>this.gapThreshold?this.heartbeatTimeoutId=egret.setTimeout(this.heartbeatTimeoutCb,this,n):(console.error("server heartbeat timeout",e),this.emit(t.EVENT_HEART_BEAT_TIMEOUT,e),this._disconnect())},o.off=function(t,e){this.removeAllListeners(t,e)},o.removeAllListeners=function(t,e){if(0==arguments.length)return void(this._callbacks={});var n=this._callbacks[t];if(n){if(t&&!e)return void delete this._callbacks[t];var i=this.index(n,e._off||e);~i&&n.splice(i,1)}},o.index=function(t,e){if([].indexOf)return t.indexOf(e);for(var n=0;n<t.length;++n)if(t[n]===e)return n;return-1},o.disconnect=function(){this._disconnect()},o._disconnect=function(){console.warn("[Pomelo] client disconnect ..."),this.socket&&this.socket.connected&&this.socket.close(),this.socket=null,this.heartbeatId&&(egret.clearTimeout(this.heartbeatId),this.heartbeatId=null),this.heartbeatTimeoutId&&(egret.clearTimeout(this.heartbeatTimeoutId),this.heartbeatTimeoutId=null)},o.processPackage=function(t){this.handlers[t.type].apply(this,[t.body])},o.handshake=function(e){var i=JSON.parse(r.strdecode(e));if(i.code===this.RES_OLD_CLIENT)return void this.emit(t.EVENT_IO_ERROR,"client version not fullfill");if(i.code!==this.RES_OK)return void this.emit(t.EVENT_IO_ERROR,"handshake fail");this.handshakeInit(i);var s=this._package.encode(n.TYPE_HANDSHAKE_ACK);this.send(s),this.initCallback&&(this.initCallback(i),this.initCallback=null)},o.handshakeInit=function(t){t.sys&&(a.init(t.sys.dict),s.init(t.sys.protos)),t.sys&&t.sys.heartbeat?(this.heartbeatInterval=1e3*t.sys.heartbeat,this.heartbeatTimeout=2*this.heartbeatInterval):(this.heartbeatInterval=0,this.heartbeatTimeout=0),"function"==typeof this.handshakeCallback&&this.handshakeCallback(t.user)},o.send=function(t){this.socket&&this.socket.connected&&(this.socket.writeBytes(t),this.socket.flush())},o.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var i=[].slice.call(arguments,1),r=this._callbacks[t];if(r){r=r.slice(0);for(var s=0,a=r.length;a>s;++s)r[s].apply(this,i)}return this},t.DEBUG=!0,t.EVENT_IO_ERROR="io-error",t.EVENT_CLOSE="close",t.EVENT_KICK="onKick",t.EVENT_HEART_BEAT_TIMEOUT="heartbeat timeout",t}();t.Pomelo=e,egret.registerClass(e,"PomeloForEgret.Pomelo");var n=function(){function t(){}var e=(__define,t),n=e.prototype;return n.encode=function(t,e){var n=e?e.length:0,i=new egret.ByteArray;return i.writeByte(255&t),i.writeByte(n>>16&255),i.writeByte(n>>8&255),i.writeByte(255&n),e&&i.writeBytes(e,0,e.length),i},n.decode=function(t){var e,n=t.readUnsignedByte(),i=(t.readUnsignedByte()<<16|t.readUnsignedByte()<<8|t.readUnsignedByte())>>>0;return t.bytesAvailable>=i?(e=new egret.ByteArray,i&&t.readBytes(e,0,i)):console.log("[Package] no enough length for current type:",n),{type:n,body:e,length:i}},t.TYPE_HANDSHAKE=1,t.TYPE_HANDSHAKE_ACK=2,t.TYPE_HEARTBEAT=3,t.TYPE_DATA=4,t.TYPE_KICK=5,t}();egret.registerClass(n,"Package",["IPackage"]);var i=function(){function t(){}var e=(__define,t),n=e.prototype;return n.encode=function(e,n,i){var o=new egret.ByteArray,h=e?t.TYPE_REQUEST:t.TYPE_NOTIFY,c=s.encode(n,i)||r.strencode(JSON.stringify(i)),l=a.getID(n)||n;if(o.writeByte(h<<1|("string"==typeof l?0:1)),e)do{var u=e%128,g=Math.floor(e/128);0!=g&&(u+=128),o.writeByte(u),e=g}while(0!=e);return l&&("string"==typeof l?(o.writeByte(255&l.length),o.writeUTFBytes(l)):(o.writeByte(l>>8&255),o.writeByte(255&l))),c&&o.writeBytes(c),o},n.decode=function(e){var n,i=e.readUnsignedByte(),o=i&t.MSG_COMPRESS_ROUTE_MASK,h=i>>1&t.MSG_TYPE_MASK,c=0;if(h===t.TYPE_REQUEST||h===t.TYPE_RESPONSE){var l=0;do{var u=e.readUnsignedByte();c+=(127&u)*Math.pow(2,7*l),l++}while(u>=128)}if(h===t.TYPE_REQUEST||h===t.TYPE_NOTIFY||h===t.TYPE_PUSH)if(o)n=e.readUnsignedShort();else{var g=e.readUnsignedByte();n=g?e.readUTFBytes(g):""}c||"string"==typeof n||(n=a.getName(n));var d=s.decode(n,e)||JSON.parse(r.strdecode(e));return{id:c,type:h,route:n,body:d}},t.MSG_FLAG_BYTES=1,t.MSG_ROUTE_CODE_BYTES=2,t.MSG_ID_MAX_BYTES=5,t.MSG_ROUTE_LEN_BYTES=1,t.MSG_ROUTE_CODE_MAX=65535,t.MSG_COMPRESS_ROUTE_MASK=1,t.MSG_TYPE_MASK=7,t.TYPE_REQUEST=0,t.TYPE_NOTIFY=1,t.TYPE_RESPONSE=2,t.TYPE_PUSH=3,t}();egret.registerClass(i,"Message",["IMessage"]);var r=function(){function t(){}var e=(__define,t);e.prototype;return t.strencode=function(t){var e=new egret.ByteArray;return e.length=t.length,e.writeUTFBytes(t),e},t.strdecode=function(t){return t.readUTFBytes(t.bytesAvailable)},t}();egret.registerClass(r,"Protocol");var s=function(){function t(){}var e=(__define,t);e.prototype;return t.init=function(t){this._clients=t&&t.client||{},this._servers=t&&t.server||{}},t.encode=function(t,e){var n=this._clients[t];return n?this.encodeProtos(n,e):null},t.decode=function(t,e){var n=this._servers[t];return n?this.decodeProtos(n,e):null},t.encodeProtos=function(t,e){var n=new egret.ByteArray;for(var i in e)if(t[i]){var r=t[i];switch(r.option){case"optional":case"required":n.writeBytes(this.encodeTag(r.type,r.tag)),this.encodeProp(e[i],r.type,t,n);break;case"repeated":e[i]&&e[i].length>0&&this.encodeArray(e[i],r,t,n)}}return n},t.decodeProtos=function(t,e){for(var n={};e.bytesAvailable;){var i=this.getHead(e),r=t.__tags[i.tag];switch(t[r].option){case"optional":case"required":n[r]=this.decodeProp(t[r].type,t,e);break;case"repeated":n[r]||(n[r]=[]),this.decodeArray(n[r],t[r].type,t,e)}}return n},t.encodeTag=function(t,e){var n=void 0!=this.TYPES[t]?this.TYPES[t]:2;return this.encodeUInt32(e<<3|n)},t.getHead=function(t){var e=this.decodeUInt32(t);return{type:7&e,tag:e>>3}},t.encodeProp=function(t,e,n,i){switch(e){case"uInt32":i.writeBytes(this.encodeUInt32(t));break;case"int32":case"sInt32":i.writeBytes(this.encodeSInt32(t));break;case"float":var r=new egret.ByteArray;r.endian=egret.Endian.LITTLE_ENDIAN,r.writeFloat(t),i.writeBytes(r);break;case"double":var s=new egret.ByteArray;s.endian=egret.Endian.LITTLE_ENDIAN,s.writeDouble(t),i.writeBytes(s);break;case"string":i.writeBytes(this.encodeUInt32(t.length)),i.writeUTFBytes(t);break;default:var a=n.__messages[e]||this._clients["message "+e];if(a){var o=this.encodeProtos(a,t);i.writeBytes(this.encodeUInt32(o.length)),i.writeBytes(o)}}},t.decodeProp=function(e,n,i){switch(e){case"uInt32":return this.decodeUInt32(i);case"int32":case"sInt32":return this.decodeSInt32(i);case"float":var r=new egret.ByteArray;i.readBytes(r,0,4),r.endian=egret.Endian.LITTLE_ENDIAN;i.readFloat();return r.readFloat();case"double":var s=new egret.ByteArray;return i.readBytes(s,0,8),s.endian=egret.Endian.LITTLE_ENDIAN,s.readDouble();case"string":var a=this.decodeUInt32(i);return i.readUTFBytes(a);default:var o=n&&(n.__messages[e]||this._servers["message "+e]);if(o){var h=this.decodeUInt32(i);if(h){var c=new egret.ByteArray;i.readBytes(c,0,h)}return h?t.decodeProtos(o,c):!1}}},t.isSimpleType=function(t){return"uInt32"===t||"sInt32"===t||"int32"===t||"uInt64"===t||"sInt64"===t||"float"===t||"double"===t},t.encodeArray=function(t,e,n,i){var r=this.isSimpleType;if(r(e.type)){i.writeBytes(this.encodeTag(e.type,e.tag)),i.writeBytes(this.encodeUInt32(t.length));for(var s=this.encodeProp,a=0;a<t.length;a++)s(t[a],e.type,n,i)}else for(var o=this.encodeTag,h=0;h<t.length;h++)i.writeBytes(o(e.type,e.tag)),this.encodeProp(t[h],e.type,n,i)},t.decodeArray=function(t,e,n,i){var r=this.isSimpleType,s=this.decodeProp;if(r(e))for(var a=this.decodeUInt32(i),o=0;a>o;o++)t.push(s(e,n,i));else t.push(s(e,n,i))},t.encodeUInt32=function(t){var e=new egret.ByteArray;do{var n=t%128,i=Math.floor(t/128);0!==i&&(n+=128),e.writeByte(n),t=i}while(0!==t);return e},t.decodeUInt32=function(t){for(var e=0,n=0;n<t.length;n++){var i=t.readUnsignedByte();if(e+=(127&i)*Math.pow(2,7*n),128>i)return e}return e},t.encodeSInt32=function(t){return t=0>t?2*Math.abs(t)-1:2*t,this.encodeUInt32(t)},t.decodeSInt32=function(t){var e=this.decodeUInt32(t),n=e%2===1?-1:1;return e=(e%2+e)/2*n},t.TYPES={uInt32:0,sInt32:0,int32:0,"double":1,string:2,message:2,"float":5},t._clients={},t._servers={},t}();egret.registerClass(s,"Protobuf");var a=function(){function t(){}var e=(__define,t);e.prototype;return t.init=function(t){this._names=t||{};var e=this._names,n=this._ids;for(var i in e)n[e[i]]=i},t.getID=function(t){return this._names[t]},t.getName=function(t){return this._ids[t]},t._ids={},t._names={},t}();egret.registerClass(a,"Routedic")}(PomeloForEgret||(PomeloForEgret={}));var Socket=function(t){function e(){t.call(this),this._needReconnect=!1,this._maxReconnectCount=10,this._reconnectCount=0}__extends(e,t);var n=(__define,e),i=n.prototype;return i.addEvents=function(){this._socket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceiveMessage,this),this._socket.addEventListener(egret.Event.CONNECT,this.onSocketOpen,this),this._socket.addEventListener(egret.Event.CLOSE,this.onSocketClose,this),this._socket.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onSocketError,this)},i.removeEvents=function(){this._socket.removeEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceiveMessage,this),this._socket.removeEventListener(egret.Event.CONNECT,this.onSocketOpen,this),this._socket.removeEventListener(egret.Event.CLOSE,this.onSocketClose,this),this._socket.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onSocketError,this)},i.onSocketOpen=function(){this._reconnectCount=0,this._connectFlag?App.MessageCenter.dispatch(SocketConst.SOCKET_RECONNECT):App.MessageCenter.dispatch(SocketConst.SOCKET_CONNECT),this._connectFlag=!0,this._isConnecting=!0},i.onSocketClose=function(){this._needReconnect?(this.reconnect(),App.MessageCenter.dispatch(SocketConst.SOCKET_START_RECONNECT)):App.MessageCenter.dispatch(SocketConst.SOCKET_CLOSE),this._isConnecting=!1},i.onSocketError=function(){this._needReconnect?this.reconnect():App.MessageCenter.dispatch(SocketConst.SOCKET_NOCONNECT),this._isConnecting=!1
},i.onReceiveMessage=function(t){this._msg.receive(this._socket)},i.initServer=function(t,e,n){this._host=t,this._port=e,this._msg=n},i.connect=function(){},i.reconnect=function(){this.close(),this._reconnectCount++,this._reconnectCount<this._maxReconnectCount?this.connect():(this._reconnectCount=0,this._connectFlag?App.MessageCenter.dispatch(SocketConst.SOCKET_CLOSE):App.MessageCenter.dispatch(SocketConst.SOCKET_NOCONNECT))},i.send=function(t){this._msg.send(this._socket,t)},i.close=function(){this.removeEvents(),this._socket.close(),this._socket=null,this._isConnecting=!1,this._connectFlag=!1},i.isConnecting=function(){return this._isConnecting},i.debugInfo=function(t){App.MessageCenter.dispatch(SocketConst.SOCKET_DEBUG_INFO,t)},e}(BaseClass);egret.registerClass(Socket,"Socket");var SocketConst=function(){function t(){}var e=(__define,t);e.prototype;return t.SOCKET_CONNECT="SOCKET_CONNECT",t.SOCKET_RECONNECT="SOCKET_RECONNECT",t.SOCKET_START_RECONNECT="SOCKET_START_RECONNECT",t.SOCKET_CLOSE="SOCKET_CLOSE",t.SOCKET_DATA="SOCKET_DATA",t.SOCKET_NOCONNECT="SOCKET_NOCONNECT",t.SOCKET_DEBUG_INFO="SOCKET_DEBUG_INFO",t}();egret.registerClass(SocketConst,"SocketConst");var UTFMsg=function(){function t(){}var e=(__define,t),n=e.prototype;return n.receive=function(t){var e=t.readUTF(),n=this.decode(e);n&&App.MessageCenter.dispatch(n.key,n.body)},n.send=function(t,e){var n=this.encode(e);n&&(t.type=egret.WebSocket.TYPE_STRING,t.writeUTF(n))},n.decode=function(t){return Log.trace("decode需要子类重写，根据项目的协议结构解析"),null},n.encode=function(t){return Log.trace("encode需要子类重写，根据项目的协议结构解析"),null},t}();egret.registerClass(UTFMsg,"UTFMsg",["BaseMsg"]);var UTFMsgByJson=function(t){function e(){t.call(this)}__extends(e,t);var n=(__define,e),i=n.prototype;return i.decode=function(t){return JSON.parse(t)},i.encode=function(t){return JSON.stringify(t)},e}(UTFMsg);egret.registerClass(UTFMsgByJson,"UTFMsgByJson");var SceneManager=function(t){function e(){t.call(this),this._scenes={}}__extends(e,t);var n=(__define,e),i=n.prototype;return i.clear=function(){var t=this._scenes[this._currScene];t&&(t.onExit(),this._currScene=void 0),this._scenes={}},i.register=function(t,e){this._scenes[t]=e},i.runScene=function(t){var e=this._scenes[t];if(null==e)return void Log.trace("场景"+t+"不存在");var n=this._scenes[this._currScene];n&&n.onExit(),e.onEnter(),this._currScene=t},i.getCurrScene=function(){return this._currScene},e}(BaseClass);egret.registerClass(SceneManager,"SceneManager");var BaseSound=function(){function t(){this._cache={},this._loadingCache=new Array,App.TimerManager.doTimer(6e4,0,this.dealSoundTimer,this)}var e=(__define,t),n=e.prototype;return n.dealSoundTimer=function(){for(var t=egret.getTimer(),e=Object.keys(this._cache),n=0,i=e.length;i>n;n++){var r=e[n];this.checkCanClear(r)&&t-this._cache[r]>=SoundManager.CLEAR_TIME&&(delete this._cache[r],RES.destroyRes(r))}},n.getSound=function(t){var e=RES.getRes(t);if(e)this._cache[t]&&(this._cache[t]=egret.getTimer());else{if(-1!=this._loadingCache.indexOf(t))return null;this._loadingCache.push(t),RES.getResAsync(t,this.onResourceLoadComplete,this)}return e},n.onResourceLoadComplete=function(t,e){var n=this._loadingCache.indexOf(e);-1!=n&&(this._loadingCache.splice(n,1),this._cache[e]=egret.getTimer(),this.loadedPlay(e))},n.loadedPlay=function(t){},n.checkCanClear=function(t){return!0},t}();egret.registerClass(BaseSound,"BaseSound");var SoundBg=function(t){function e(){t.call(this),this._currBg=""}__extends(e,t);var n=(__define,e),i=n.prototype;return i.stop=function(){this._currSoundChannel&&this._currSoundChannel.stop(),this._currSoundChannel=null,this._currSound=null,this._currBg=""},i.play=function(t){if(this._currBg!=t){this.stop(),this._currBg=t;var e=this.getSound(t);e&&this.playSound(e)}},i.playSound=function(t){this._currSound=t,this._currSoundChannel=this._currSound.play(0,1),this._currSoundChannel.volume=this._volume},i.setVolume=function(t){this._volume=t,this._currSoundChannel&&(this._currSoundChannel.volume=this._volume)},i.loadedPlay=function(t){this._currBg==t&&this.playSound(RES.getRes(t))},i.checkCanClear=function(t){return this._currBg!=t},e}(BaseSound);egret.registerClass(SoundBg,"SoundBg");var SoundEffects=function(t){function e(){t.call(this)}__extends(e,t);var n=(__define,e),i=n.prototype;return i.play=function(t){var e=this.getSound(t);e&&this.playSound(e)},i.playSound=function(t){var e=t.play(0,1);e.volume=this._volume},i.setVolume=function(t){this._volume=t},i.loadedPlay=function(t){this.playSound(RES.getRes(t))},e}(BaseSound);egret.registerClass(SoundEffects,"SoundEffects");var SoundManager=function(t){function e(){t.call(this),this.bgOn=!0,this.effectOn=!0,this.bgVolume=.5,this.effectVolume=.5,this.bg=new SoundBg,this.bg.setVolume(this.bgVolume),this.effect=new SoundEffects,this.effect.setVolume(this.effectVolume)}__extends(e,t);var n=(__define,e),i=n.prototype;return i.playEffect=function(t){this.effectOn&&this.effect.play(t)},i.playBg=function(t){this.currBg=t,this.bgOn&&this.bg.play(t)},i.stopBg=function(){this.bg.stop()},i.setEffectOn=function(t){this.effectOn=t},i.setBgOn=function(t){this.bgOn=t,this.bgOn?this.currBg&&this.playBg(this.currBg):this.stopBg()},i.setBgVolume=function(t){t=Math.min(t,1),t=Math.max(t,0),this.bgVolume=t,this.bg.setVolume(this.bgVolume)},i.getBgVolume=function(){return this.bgVolume},i.setEffectVolume=function(t){t=Math.min(t,1),t=Math.max(t,0),this.effectVolume=t,this.effect.setVolume(this.effectVolume)},i.getEffectVolume=function(){return this.effectVolume},e.CLEAR_TIME=18e4,e}(BaseClass);egret.registerClass(SoundManager,"SoundManager");var starlingswf;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var n=(__define,e),i=n.prototype;return i.getTextField=function(t){return this.getChildByName(t)},i.getMovie=function(t){return this.getChildByName(t)},i.getSprite=function(t){return this.getChildByName(t)},i.getImage=function(t){return this.getChildByName(t)},e}(egret.DisplayObjectContainer);t.SwfSprite=e,egret.registerClass(e,"starlingswf.SwfSprite")}(starlingswf||(starlingswf={}));var starlingswf;!function(t){var e=function(e){function n(t,n,i,r){e.call(this),this._isPlay=!1,this.loop=!0,this._completeFunction=null,this._hasCompleteListener=!1,this._frames=t,this._labels=n,this._displayObjects=i,this._startFrame=0,this._endFrame=this._frames.length-1,this._ownerSwf=r,this.setCurrentFrame(0),this.play()}__extends(n,e);var i=(__define,n),r=i.prototype;return r.update=function(){if(this._isPlay)if(this._currentFrame>this._endFrame){if(this._hasCompleteListener&&this.dispatchEventWith(egret.Event.COMPLETE),this._currentFrame=this._startFrame,!this.loop)return void(this._ownerSwf&&this.stop(!1));if(this._startFrame==this._endFrame)return void(this._ownerSwf&&this.stop(!1));this.setCurrentFrame(this._startFrame)}else this.setCurrentFrame(this._currentFrame),this._currentFrame+=1},r.setCurrentFrame=function(e){this.$children.length=0,this._currentFrame=e,this.__frameInfos=this._frames[this._currentFrame];for(var n,i,r,s,a=this.__frameInfos.length,o=0;a>o;o++)n=this.__frameInfos[o],s=n[10],i=this._displayObjects[n[0]][s],i.skewX=n[6],i.skewY=n[7],i.alpha=n[8],i.name=n[9],i.x=n[2],i.y=n[3],n[1]==t.Swf.dataKey_Scale9?(i.width=n[11],i.height=n[12]):(i.scaleX=n[4],i.scaleY=n[5]),this.$children.push(i),i.$parent=this,n[1]==t.Swf.dataKey_TextField&&(r=i,r.width=n[11],r.height=n[12],r.textColor=n[14],r.size=n[15],r.textAlign=n[16],n[19]&&"\r"!=n[19]&&""!=n[19]&&(r.text=n[19]))},r.getCurrentFrame=function(){return this._currentFrame},r.play=function(){this._isPlay=!0,this._ownerSwf.swfUpdateManager.addSwfAnimation(this);var e,n,i;for(e in this._displayObjects)if(0==e.indexOf(t.Swf.dataKey_MovieClip)){n=this._displayObjects[e],i=n.length;for(var r=0;i>r;r++)n[r].play()}},r.stop=function(e){if(void 0===e&&(e=!0),this._isPlay=!1,this._ownerSwf.swfUpdateManager.removeSwfAnimation(this),e){var n,i,r;for(n in this._displayObjects)if(0==n.indexOf(t.Swf.dataKey_MovieClip)){i=this._displayObjects[n],r=i.length;for(var s=0;r>s;s++)i[s].stop(e)}}},r.gotoAndStop=function(t,e){void 0===e&&(e=!0),this.goTo(t),this.stop(e)},r.gotoAndPlay=function(t){this.goTo(t),this.play()},r.goTo=function(t){if("string"==typeof t){var e=this.getLabelData(t);this._currentLabel=e[0],this._currentFrame=this._startFrame=e[1],this._endFrame=e[2]}else"number"==typeof t&&(this._currentFrame=this._startFrame=t,this._endFrame=this._frames.length-1);this.setCurrentFrame(this._currentFrame)},r.getLabelData=function(t){for(var e,n=this._labels.length,i=0;n>i;i++)if(e=this._labels[i],e[0]==t)return e;return null},r.isPlay=function(){return this._isPlay},r.totalFrames=function(){return this._frames.length},r.currentLabel=function(){return this._currentLabel},r.labels=function(){for(var t=this._labels.length,e=[],n=0;t>n;n++)e.push(this._labels[n][0]);return e},r.hasLabel=function(t){var e=this.labels();return!(-1==e.indexOf(t))},r.addEventListener=function(t,n,i,r,s){void 0===r&&(r=!1),void 0===s&&(s=0),e.prototype.addEventListener.call(this,t,n,i,r,s),this._hasCompleteListener=this.hasEventListener(egret.Event.COMPLETE)},r.removeEventListener=function(t,n,i,r){void 0===r&&(r=!1),e.prototype.removeEventListener.call(this,t,n,i,r),this._hasCompleteListener=this.hasEventListener(egret.Event.COMPLETE)},r.getLabelStartFrame=function(t){return this.getLabelData(t)[1]},r.getLabelEndFrame=function(t){return this.getLabelData(t)[2]},n}(t.SwfSprite);t.SwfMovieClip=e,egret.registerClass(e,"starlingswf.SwfMovieClip",["starlingswf.ISwfAnimation"])}(starlingswf||(starlingswf={}));var StarlingSwfFactory=function(t){function e(){t.call(this),this.swfAssetsManager=new starlingswf.SwfAssetManager,this.swfAssetsNames=new Array,this.swfAssets=new Array,this.swfData={}}__extends(e,t);var n=(__define,e),i=n.prototype;return i.addSwf=function(t,e,n){if(-1==this.swfAssetsNames.indexOf(t)){if(null==e||null==n)return void console.log("SWF加载失败:"+t);this.swfAssetsManager.addSpriteSheet(t,n);var i=new starlingswf.Swf(e,this.swfAssetsManager,24);i.name=t,StarlingSwfUtils.addSwf(i),this.swfAssetsNames.push(t),this.swfAssets.push(i)}},i.stopSwfs=function(t){for(var e=0,n=t.length;n>e;e++){var i=StarlingSwfUtils.getSwf(t[e]);i&&i.swfUpdateManager.stop()}},i.playSwfs=function(t){for(var e=0,n=t.length;n>e;e++){var i=StarlingSwfUtils.getSwf(t[e]);i&&i.swfUpdateManager.play()}},i.clearSwfs=function(){for(;this.swfAssets.length;)StarlingSwfUtils.removeSwf(this.swfAssets.pop());for(;this.swfAssetsNames.length;)this.swfAssetsNames.pop();this.swfAssetsManager=new starlingswf.SwfAssetManager},i.clear=function(){this.clearSwfs()},i.makeMc=function(t){var e=StarlingSwfUtils.createMovie("mc_"+t,null,StarlingSwfMovieClip);return null==e&&console.log("SWF创建失败: "+t),e},i.makeImage=function(t){return StarlingSwfUtils.createImage("img_"+t)},i.getTexture=function(t){return StarlingSwfUtils.getTexture("img_"+t)},e}(BaseClass);egret.registerClass(StarlingSwfFactory,"StarlingSwfFactory");var StarlingSwfMovieClip=function(t){function e(e,n,i,r){t.call(this,e,n,i,r),this.frameActions={},this.preFrame=-1,this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemove,this)}__extends(e,t);var n=(__define,e),i=n.prototype;return i.onRemove=function(){this.stop()},i.setFrameAction=function(t,e,n,i){void 0===i&&(i=null),this.frameActions[t]=[e,n,i]},i.setCompleteAction=function(t,e){this.complateFunc=t,this.complateObj=e,this.addEventListener(egret.Event.COMPLETE,this.onPlayend,this)},i.onPlayend=function(){this.complateFunc&&this.complateFunc.call(this.complateObj)},i.goToPlay=function(t){this.preFrame=-1,this.currFrameName=t,this.gotoAndPlay(t)},i.setCurrentFrame=function(e){t.prototype.setCurrentFrame.call(this,e);var n=this.getCurrentFrame();if(this.preFrame!=n&&(this.preFrame=n,this.frameActions&&this.frameActions[n])){var i=this.frameActions[n];i[2]?i[0].call(i[1],i[2]):i[0].call(i[1])}},i.dispose=function(){this.stop(),this.removeEventListener(egret.Event.COMPLETE,this.onPlayend,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemove,this),App.DisplayUtils.removeFromParent(this),this.complateFunc=null,this.complateObj=null,this.frameActions=null},e}(starlingswf.SwfMovieClip);egret.registerClass(StarlingSwfMovieClip,"StarlingSwfMovieClip");var StarlingSwfUtils=function(){function t(){}var e=(__define,t);e.prototype;return t.addSwf=function(e){t.swfList.push(e)},t.removeSwf=function(e){var n=t.swfList.indexOf(e);-1!=n&&t.swfList.splice(n,1)},t.createSprite=function(e,n,i){void 0===n&&(n=null),void 0===i&&(i=null);for(var r=t.swfList.length,s=0;r>s;s++){var a=t.swfList[s];if(a.hasSprite(e))return a.createSprite(e,n,i)}return null},t.createImage=function(e,n){void 0===n&&(n=null);for(var i=t.swfList.length,r=0;i>r;r++){var s=t.swfList[r];if(s.hasImage(e))return s.createImage(e,n)}return null},t.getTexture=function(e){for(var n=t.swfList.length,i=0;n>i;i++){var r=t.swfList[i];if(r.hasImage(e))return r.getTexture(e)}return null},t.createMovie=function(e,n,i){void 0===n&&(n=null),void 0===i&&(i=null);for(var r=t.swfList.length,s=0;r>s;s++){var a=t.swfList[s];if(a.hasMovieClip(e))return a.createMovie(e,n,i)}return null},t.createS9Image=function(e,n){void 0===n&&(n=null);for(var i=t.swfList.length,r=0;i>r;r++){var s=t.swfList[r];if(s.hasS9Image(e))return s.createS9Image(e,n)}return null},t.createShapeImage=function(e,n){void 0===n&&(n=null);for(var i=t.swfList.length,r=0;i>r;r++){var s=t.swfList[r];if(s.hasShapeImage(e))return s.createShapeImage(e,n)}return null},t.getSwf=function(e){for(var n=t.swfList.length,i=0;n>i;i++){var r=t.swfList[i];if(r.name==e)return r}return null},t.fixButton=function(e,n,i){t.firstAddBtn&&(t.firstAddBtn=!1,egret.MainContext.instance.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),egret.MainContext.instance.stage.addEventListener(egret.Event.LEAVE_STAGE,this.onTouchEnd,this));var r=new StarlingSwfButtonData;r.btn=e,r.onClick=n,r.thisObj=i,t.btnList.push(r),e.touchEnabled=!0,e.gotoAndStop(0),e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onBtnTouchBegin,e)},t.onBtnTouchBegin=function(e){for(var n=e.currentTarget,i=t.btnList.length,r=0;i>r;r++){var s=t.btnList[r];if(s.btn==n){s.touchStageX=e.stageX,s.touchStageY=e.stageY,n.gotoAndStop(1);break}}},t.onTouchEnd=function(e){for(var n=t.btnList.length,i=0;n>i;i++){var r=t.btnList[i];-1!=r.touchStageX&&(e.stageX&&Math.abs(r.touchStageX-e.stageX)<10&&Math.abs(r.touchStageY-e.stageY)<10&&r.onClick&&r.onClick.call(r.thisObj,e),r.touchStageX=-1,r.touchStageY=-1,r.btn.gotoAndStop(0))}},t.swfList=[],t.btnList=[],t.firstAddBtn=!0,t}();egret.registerClass(StarlingSwfUtils,"StarlingSwfUtils");var StarlingSwfButtonData=function(){function t(){this.touchStageX=-1,this.touchStageY=-1}var e=(__define,t);e.prototype;return t}();egret.registerClass(StarlingSwfButtonData,"StarlingSwfButtonData");var starlingswf;!function(t){var e=function(){function e(n,i,r){void 0===r&&(r=24),this._swfData=n,this._assetManager=i,this._createDisplayFuns=new Object,this._createDisplayFuns[e.dataKey_Sprite]=this.createSprite,this._createDisplayFuns[e.dataKey_MovieClip]=this.createMovie,this._createDisplayFuns[e.dataKey_Image]=this.createImage,this._createDisplayFuns[e.dataKey_Scale9]=this.createS9Image,this._createDisplayFuns[e.dataKey_ShapeImg]=this.createShapeImage,this._createDisplayFuns[e.dataKey_TextField]=this.createTextField,this.swfUpdateManager=t.SwfUpdateManager.createSwfUpdateManager(r)}var n=(__define,e),i=n.prototype;return i.createSprite=function(n,i,r){void 0===i&&(i=null),void 0===r&&(r=null),null==r&&(r=this._swfData[e.dataKey_Sprite][n]);for(var s,a,o,h=new t.SwfSprite,c=r.length,l=0;c>l;l++)s=r[l],o=this._createDisplayFuns[s[1]],null!=o&&(a=o.apply(this,[s[0],s]),a.name=s[9],a.x=s[2],a.y=s[3],s[0]==e.dataKey_TextField,s[1]!=e.dataKey_Scale9&&s[1]!=e.dataKey_ShapeImg&&(a.scaleX=s[4],a.scaleY=s[5]),a.skewX=s[6],a.skewY=s[7],a.alpha=s[8],h.addChild(a));return h},i.createMovie=function(n,i,r){void 0===i&&(i=null),void 0===r&&(r=null);var s,a,o,h,c,l=this._swfData[e.dataKey_MovieClip][n],u=l.objCount,g={};for(c in u){a=u[c][0],o=u[c][1],s=null==g[c]?[]:g[c];for(var d=0;o>d;d++)h=this._createDisplayFuns[a],null!=h&&s.push(h.apply(this,[c,null]));g[c]=s}var f;return f=null==r?new t.SwfMovieClip(l.frames,l.labels,g,this):new r(l.frames,l.labels,g,this),f.loop=l.loop,f},i.createImage=function(t,n){void 0===n&&(n=null);var i=this._swfData[e.dataKey_Image][t],r=this._assetManager.createBitmap(t);return r.anchorOffsetX=i[0],r.anchorOffsetY=i[1],r},i.getTexture=function(t){return this._assetManager.getTexture(t)},i.createS9Image=function(t,n){void 0===n&&(n=null);var i=this._swfData[e.dataKey_Scale9][t],r=this._assetManager.createBitmap(t);return r.scale9Grid=new egret.Rectangle(i[0],i[1],i[2],i[3]),null!=n&&(r.width=n[10],r.height=n[11]),r},i.createShapeImage=function(t,e){void 0===e&&(e=null);var n=this._assetManager.createBitmap(t);return n.fillMode=egret.BitmapFillMode.REPEAT,null!=e&&(n.width=e[10],n.height=e[11]),n},i.createTextField=function(t,e){void 0===e&&(e=null);var n=new egret.TextField;return null!=e&&(n.width=e[10],n.height=e[11],n.textColor=e[13],n.size=e[14],n.textAlign=e[15],n.text=e[18]),n},i.hasSprite=function(t){return null!=this._swfData[e.dataKey_Sprite][t]},i.hasMovieClip=function(t){return null!=this._swfData[e.dataKey_MovieClip][t]},i.hasImage=function(t){return null!=this._swfData[e.dataKey_Image][t]},i.hasS9Image=function(t){return null!=this._swfData[e.dataKey_Scale9][t]},i.hasShapeImage=function(t){return null!=this._swfData[e.dataKey_ShapeImg][t]},e.dataKey_Sprite="spr",e.dataKey_Image="img",e.dataKey_MovieClip="mc",e.dataKey_TextField="text",e.dataKey_Button="btn",e.dataKey_Scale9="s9",e.dataKey_ShapeImg="shapeImg",e.dataKey_Component="comp",e.dataKey_Particle="particle",e}();t.Swf=e,egret.registerClass(e,"starlingswf.Swf")}(starlingswf||(starlingswf={}));var starlingswf;!function(t){var e=function(){function t(){this._sheets={},this._textures={}}var e=(__define,t),n=e.prototype;return n.addSpriteSheet=function(t,e){this._sheets[t]=e},n.addTexture=function(t,e){this._textures[t]=e},n.createBitmap=function(t){var e=this.getTexture(t);if(null==e)return null;var n=new egret.Bitmap;return n.texture=e,n},n.getTexture=function(t){var e,n,i;for(i in this._sheets)if(n=this._sheets[i],e=n.getTexture(t),null!=e)break;return null==e&&(e=this._textures[t]),e},t}();t.SwfAssetManager=e,egret.registerClass(e,"starlingswf.SwfAssetManager")}(starlingswf||(starlingswf={}));var starlingswf;!function(t){var e=function(){function t(){}var e=(__define,t),n=e.prototype;return t.createSwfUpdateManager=function(e){var n=new t;return n._animations=[],n._addQueue=[],n._removeQueue=[],n._currentTime=0,n.setFps(e),App.TimerManager.doFrame(1,0,n.update,n),n},n.clear=function(){this._addQueue.splice(0),this._removeQueue.splice(0),this._animations.splice(0)},n.stop=function(){this.clear(),App.TimerManager.remove(this.update,this)},n.play=function(){App.TimerManager.doFrame(1,0,this.update,this)},n.setFps=function(t){this._fps=t,this._fpsTime=1e3/t},n.addSwfAnimation=function(t){this._addQueue.push(t)},n.removeSwfAnimation=function(t){this._removeQueue.push(t);var e=this._addQueue.indexOf(t);-1!=e&&this._addQueue.splice(e,1)},n.updateAdd=function(){for(var t,e,n=this._addQueue.length,i=0;n>i;i++)e=this._addQueue.pop(),t=this._animations.indexOf(e),-1==t&&this._animations.push(e)},n.updateRemove=function(){for(var t,e,n=this._removeQueue.length,i=0;n>i;i++)e=this._removeQueue.pop(),t=this._animations.indexOf(e),-1!=t&&this._animations.splice(t,1)},n.update=function(t){if(this._currentTime+=t,!(this._currentTime<this._fpsTime)){this._currentTime-=this._fpsTime,this._update();for(var e=0;this._currentTime>this._fpsTime;)this._currentTime-=this._fpsTime,e++,4>e&&this._update()}},n._update=function(){this.updateRemove(),this.updateAdd();for(var t=this._animations.length,e=0;t>e;e++)this._animations[e].update()},t}();t.SwfUpdateManager=e,egret.registerClass(e,"starlingswf.SwfUpdateManager")}(starlingswf||(starlingswf={}));var AllAsyncExecutor=function(){function t(){this._functions=new Array,this._complateNum=0}var e=(__define,t),n=e.prototype;return n.setCallBack=function(t,e){this._callBack=t,this._callBackTarget=e},n.regist=function(t,e){this._functions.push([t,e])},n.start=function(){App.ArrayUtils.forEach(this._functions,function(t){t[0].call(t[1])},this)},n.complate=function(){this._functions&&(this._complateNum++,this._complateNum==this._functions.length&&(this._callBack&&this._callBack.call(this._callBackTarget),this._callBack=null,this._callBackTarget=null,this._functions=null))},t}();egret.registerClass(AllAsyncExecutor,"AllAsyncExecutor");var AnchorUtil=function(){function t(){}var e=(__define,t);e.prototype;return t.init=function(){t._propertyChange=Object.create(null),t._anchorChange=Object.create(null),t.injectAnchor()},t.setAnchorX=function(t,e){t.anchorX=e},t.setAnchorY=function(t,e){t.anchorY=e},t.setAnchor=function(t,e){t.anchorX=t.anchorY=e},t.getAnchor=function(t){return t.anchorX!=t.anchorY&&console.log("target's anchorX != anchorY"),t.anchorX||0},t.getAnchorY=function(t){return t.anchorY||0},t.getAnchorX=function(t){return t.anchorX||0},t.injectAnchor=function(){Object.defineProperty(egret.DisplayObject.prototype,"width",{get:function(){return this.$getWidth()},set:function(e){var n=this;this.$setWidth(e),t._propertyChange[this.hashCode]=!0,egret.callLater(function(){t.changeAnchor(n)},this)},enumerable:!0,configurable:!0}),Object.defineProperty(egret.DisplayObject.prototype,"height",{get:function(){return this.$getHeight()},set:function(e){var n=this;this.$setHeight(e),t._propertyChange[this.hashCode]=!0,egret.callLater(function(){t.changeAnchor(n)},this)},enumerable:!0,configurable:!0}),Object.defineProperty(egret.DisplayObject.prototype,"anchorX",{get:function(){return this._anchorX},set:function(e){var n=this;this._anchorX=e,t._propertyChange[this.hashCode]=!0,t._anchorChange[this.hashCode]=!0,egret.callLater(function(){t.changeAnchor(n)},this)},enumerable:!0,configurable:!0}),Object.defineProperty(egret.DisplayObject.prototype,"anchorY",{get:function(){return this._anchorY},set:function(e){var n=this;this._anchorY=e,t._propertyChange[this.hashCode]=!0,t._anchorChange[this.hashCode]=!0,egret.callLater(function(){t.changeAnchor(n)},this)},enumerable:!0,configurable:!0})},t.changeAnchor=function(e){t._propertyChange[e.hashCode]&&t._anchorChange[e.hashCode]&&(e.anchorOffsetX=e._anchorX*e.width,e.anchorOffsetY=e._anchorY*e.height,delete t._propertyChange[e.hashCode])},t}();egret.registerClass(AnchorUtil,"AnchorUtil");var ArrayUtils=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var n=(__define,e),i=n.prototype;return i.forEach=function(t,e,n){for(var i=0,r=t.length;r>i;i++)e.apply(n,[t[i]])},e}(BaseClass);egret.registerClass(ArrayUtils,"ArrayUtils");var AverageUtils=function(){function t(t){void 0===t&&(t=10),this.nums=[],this.numsLen=0,this.numSum=0,this.maxNum=t}var e=(__define,t),n=e.prototype;return n.push=function(t){this.numsLen>this.maxNum&&(this.numsLen--,this.numSum-=this.nums.shift()),this.nums.push(t),this.numSum+=t,this.numsLen++},n.getValue=function(){return this.numSum/this.numsLen},n.clear=function(){this.nums.splice(0),this.numsLen=0,this.numSum=0},t}();egret.registerClass(AverageUtils,"AverageUtils");var CommonUtils=function(t){function e(){t.call(this)}__extends(e,t);var n=(__define,e);n.prototype;return e.addLableStrokeColor=function(t,e,n){t.strokeColor=e,t.stroke=n},e.copyDataHandler=function(t){var e;if(t instanceof Array)e=[];else{if(!(t instanceof Object))return t;e={}}for(var n=Object.keys(t),i=0,r=n.length;r>i;i++){var s=n[i];e[s]=this.copyDataHandler(t[s])}return e},e.lock=function(){App.StageUtils.getStage().touchEnabled=App.StageUtils.getStage().touchChildren=!1},e.unlock=function(){App.StageUtils.getStage().touchEnabled=App.StageUtils.getStage().touchChildren=!0},e.int64ToNumber=function(t){return parseInt(t.toString())},e.labelIsOverLenght=function(t,e){var n=null;n=1e5>e?e:1e6>e?Math.floor(e/1e3/10).toString()+"万":Math.floor(e/1e4).toString()+"万",t.text=n},e}(BaseClass);egret.registerClass(CommonUtils,"CommonUtils");var DateUtils=function(t){function e(){t.call(this)}__extends(e,t);var n=(__define,e),i=n.prototype;return i.getFormatBySecond=function(t,e){void 0===e&&(e=1);var n="";switch(e){case 1:n=this.getFormatBySecond1(t);break;case 2:n=this.getFormatBySecond2(t);break;case 3:n=this.getFormatBySecond3(t);break;case 4:n=this.getFormatBySecond4(t);break;case 5:n=this.getFormatBySecond5(t)}return n},i.getFormatBySecond1=function(t){void 0===t&&(t=0);var e,n=Math.floor(t/3600);e=0==n?"00":10>n?"0"+n:""+n;var i,r,s=Math.floor((t-3600*n)/60),a=Math.floor((t-3600*n)%60);return i=0==s?"00":10>s?"0"+s:""+s,r=0==a?"00":10>a?"0"+a:""+a,e+":"+i+":"+r},i.getFormatBySecond3=function(t){void 0===t&&(t=0);var e,n,i=Math.floor(t/3600),r=Math.floor((t-3600*i)/60),s=Math.floor((t-3600*i)%60);return e=0==r?"00":10>r?"0"+r:""+r,n=0==s?"00":10>s?"0"+s:""+s,e+":"+n},i.getFormatBySecond2=function(t){var e=new Date(t),n=e.getFullYear(),i=e.getMonth()+1,r=e.getDate(),s=e.getHours(),a=e.getMinutes(),o=e.getSeconds();return n+"-"+i+"-"+r+" "+s+":"+a+":"+o},i.getFormatBySecond4=function(t){var e=Math.floor(t/3600);return e>0?e>24?Math.floor(e/24)+"天前":e+"小时前":Math.floor(t/60)+"分钟前"},i.getFormatBySecond5=function(t){var e=86400,n=3600,i=60,r=Math.floor(t/e),s=Math.floor(t%e/n),a=Math.floor((t-s*n)/i),o=Math.floor((t-s*n)%i),h="",c="",l="",u="";return t>0?0==r?(h="",0==s?(c="",0==a?(l="",u=0==o?"":10>o?"0"+o+"秒":""+o+"秒"):(l=""+a+"分",u=0==o?"":10>o?"0"+o+"秒":""+o+"秒",l+u)):(c=s+"小时",0==a?(l="",u=0==o?"":10>o?"0"+o+"秒":""+o+"秒"):(l=10>a?"0"+a+"分":""+a+"分",c+l))):(h=r+"天",c=0==s?"":10>s?"0"+s+"小时":""+s+"小时",h+c):""},e}(BaseClass);egret.registerClass(DateUtils,"DateUtils");var DebugUtils=function(t){function e(){t.call(this),this._threshold=3,this._startTimes={}}__extends(e,t);var n=__define,i=e,r=i.prototype;return r.isOpen=function(t){this._isOpen=t},n(r,"isDebug",function(){return this._isOpen}),r.start=function(t){this._isOpen&&(this._startTimes[t]=egret.getTimer())},r.stop=function(t){if(!this._isOpen)return 0;if(!this._startTimes[t])return 0;var e=egret.getTimer()-this._startTimes[t];return e>this._threshold,e},r.setThreshold=function(t){this._threshold=t},e}(BaseClass);egret.registerClass(DebugUtils,"DebugUtils");var DelayOptManager=function(t){function e(){t.call(this),this.TIME_THRESHOLD=2,this._delayOpts=[],App.TimerManager.doFrame(1,0,this.runCachedFun,this)}__extends(e,t);var n=(__define,e),i=n.prototype;return i.addDelayOptFunction=function(t,e,n,i,r){this._delayOpts.push({fun:e,funPara:n,thisObj:t,callBack:i,para:r})},i.clear=function(){this._delayOpts.length=0},i.stop=function(){App.TimerManager.remove(this.runCachedFun,this)},i.runCachedFun=function(t){if(0!=this._delayOpts.length)for(var e,n=egret.getTimer();this._delayOpts.length&&(e=this._delayOpts.shift(),e.funPara?e.fun.call(e.thisObj,e.funPara):e.fun.call(e.thisObj),e.callBack&&(void 0!=e.para?e.callBack.call(e.thisObj,e.para):e.callBack()),!(egret.getTimer()-n>this.TIME_THRESHOLD)););},e}(BaseClass);egret.registerClass(DelayOptManager,"DelayOptManager");var DeviceUtils=function(t){function e(){t.call(this)}__extends(e,t);var n=__define,i=e,r=i.prototype;return n(r,"IsHtml5",function(){return egret.Capabilities.runtimeType==egret.RuntimeType.WEB}),n(r,"IsNative",function(){return egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE}),n(r,"IsMobile",function(){return egret.Capabilities.isMobile}),n(r,"IsPC",function(){return!egret.Capabilities.isMobile}),n(r,"IsQQBrowser",function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("MQQBrowser")}),n(r,"IsIEBrowser",function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("MSIE")}),n(r,"IsFirefoxBrowser",function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Firefox")}),n(r,"IsChromeBrowser",function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Chrome")}),n(r,"IsSafariBrowser",function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Safari")}),n(r,"IsOperaBrowser",function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Opera")}),e}(BaseClass);egret.registerClass(DeviceUtils,"DeviceUtils");var DisplayUtils=function(t){function e(){t.call(this)}__extends(e,t);var n=(__define,e),i=n.prototype;return i.createBitmap=function(t){var e=new egret.Bitmap,n=RES.getRes(t);return e.texture=n,e},i.createEuiImage=function(t){var e=new eui.Image,n=RES.getRes(t);return e.source=n,e},i.removeFromParent=function(t){null!=t.parent&&t.parent.removeChild(t)},e}(BaseClass);egret.registerClass(DisplayUtils,"DisplayUtils");var EffectUtils=function(t){function e(){t.call(this)}__extends(e,t);var n=(__define,e),i=n.prototype;return i.macIconShake=function(t,e){for(var n=[[20,300],[15,300],[10,300],[5,300]],i="egret.Tween.get("+t+")",r=0,s=n.length;s>r;r++)i+=".to({'y':"+e+"-"+n[r][0]+"}, "+n[r][1]+")",i+=".to({'y':"+e+"}, "+n[r][1]+")";return i+=";"},i.startFlicker=function(t,e){t.alpha=1,egret.Tween.get(t).to({alpha:0},e).to({alpha:1},e).call(this.startFlicker,this,[t])},i.stopFlicker=function(t){egret.Tween.removeTweens(t)},e}(BaseClass);egret.registerClass(EffectUtils,"EffectUtils");var EgretExpandUtils=function(t){function e(){t.call(this)}__extends(e,t);var n=(__define,e),i=n.prototype;return i.init=function(){AnchorUtil.init()},e}(BaseClass);egret.registerClass(EgretExpandUtils,"EgretExpandUtils");var FrameDelay=function(){function t(){}var e=(__define,t),n=e.prototype;return n.delayCall=function(t,e,n){this.func=e,this.thisObj=n,App.TimerManager.doFrame(t,1,this.listener_enterFrame,this)},n.listener_enterFrame=function(){this.func.call(this.thisObj)},t}();egret.registerClass(FrameDelay,"FrameDelay");var FrameExecutor=function(){function t(t){this.delayFrame=t,this.frameDelay=new FrameDelay,this.functions=new Array}var e=(__define,t),n=e.prototype;return n.regist=function(t,e){this.functions.push([t,e])},n.execute=function(){if(this.functions.length){var t=this.functions.shift();t[0].call(t[1]),this.frameDelay.delayCall(this.delayFrame,this.execute,this)}},t}();egret.registerClass(FrameExecutor,"FrameExecutor");var KeyboardUtils=function(t){function e(){if(t.call(this),this.key_ups=new Array,this.key_downs=new Array,App.DeviceUtils.IsHtml5){var e=this;document.addEventListener("keyup",function(t){for(var n=0,i=e.key_ups.length;i>n;n++){var r=e.key_ups[n][0],s=e.key_ups[n][1];s?r.call(s,t.keyCode):r(t.keyCode)}}),document.addEventListener("keydown",function(t){for(var n=0,i=e.key_downs.length;i>n;n++){var r=e.key_downs[n][0],s=e.key_downs[n][1];s?r.call(s,t.keyCode):r(t.keyCode)}})}}__extends(e,t);var n=(__define,e),i=n.prototype;return i.addKeyUp=function(t,e){this.key_ups.push([t,e])},i.addKeyDown=function(t,e){this.key_downs.push([t,e])},i.removeKeyUp=function(t,e){for(var n=0;n<this.key_ups.length;n++)this.key_ups[n][0]==t&&this.key_ups[n][1]==e&&(this.key_ups.splice(n,1),n--)},i.removeKeyDown=function(t,e){for(var n=0;n<this.key_downs.length;n++)this.key_downs[n][0]==t&&this.key_downs[n][1]==e&&(this.key_downs.splice(n,1),n--)},e}(BaseClass);egret.registerClass(KeyboardUtils,"KeyboardUtils");var LocationProperty=function(){function t(){}var e=(__define,t);e.prototype;return t.getPara=function(t,e){if(egret.MainContext.runtimeType==egret.MainContext.RUNTIME_NATIVE)return null;var n=e||location.href;if(-1!=n.indexOf("?")){var i="&"+n.split("?")[1],r=new RegExp("&"+t+"=.*?(?:&|$)"),s=r.exec(i);if(s){var a=s[0];return a.split("&")[1].split("=")[1]}}return null},t.setProperty=function(t,e,n){var i=n||location.href,r="&"+i.split("?")[1];if(-1==i.indexOf("?"))return i+="?"+t+"="+e;var r=i.split("?")[1];if(""==r)return i+=t+"="+e;var s=new RegExp("(?:^|&)"+t+"=.*?(?:&|$)"),a=s.exec(r);if(a&&""!=a[0]){var o=a[0],h=new RegExp("=.*$"),c=o.replace(h,"="+e);return i.replace(o,c)}return i+="&"+t+"="+e},t.hasProperty=function(t,e){var n=e||location.href,i="&"+n.split("?")[1];
return-1!=i.indexOf("&"+t+"=")},t}();egret.registerClass(LocationProperty,"LocationProperty");var Log=function(){function t(){}var e=(__define,t);e.prototype;return t.trace=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];App.DebugUtils.isDebug&&(t[0]="[DebugLog]"+t[0],console.log.apply(console,t))},t}();egret.registerClass(Log,"Log");var MathUtils=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var n=(__define,e),i=n.prototype;return i.getAngle=function(t){return 180*t/Math.PI},i.getRadian=function(t){return Math.PI=t/180*Math.PI},i.getRadian2=function(t,e,n,i){var r=n-t,s=i-e;return Math.atan2(s,r)},i.getDistance=function(t,e,n,i){var r=n-t,s=i-e,a=r*r+s*s;return Math.sqrt(a)},e}(BaseClass);egret.registerClass(MathUtils,"MathUtils");var md5=function(){function t(){this.hexcase=0,this.b64pad=""}var e=(__define,t),n=e.prototype;return n.hex_md5=function(t){return this.rstr2hex(this.rstr_md5(this.str2rstr_utf8(t)))},n.b64_md5=function(t){return this.rstr2b64(this.rstr_md5(this.str2rstr_utf8(t)))},n.any_md5=function(t,e){return this.rstr2any(this.rstr_md5(this.str2rstr_utf8(t)),e)},n.hex_hmac_md5=function(t,e){return this.rstr2hex(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},n.b64_hmac_md5=function(t,e){return this.rstr2b64(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},n.any_hmac_md5=function(t,e,n){return this.rstr2any(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)),n)},n.md5_vm_test=function(){return"900150983cd24fb0d6963f7d28e17f72"==this.hex_md5("abc").toLowerCase()},n.rstr_md5=function(t){return this.binl2rstr(this.binl_md5(this.rstr2binl(t),8*t.length))},n.rstr_hmac_md5=function(t,e){var n=this.rstr2binl(t);n.length>16&&(n=this.binl_md5(n,8*t.length));for(var i=Array(16),r=Array(16),s=0;16>s;s++)i[s]=909522486^n[s],r[s]=1549556828^n[s];var a=this.binl_md5(i.concat(this.rstr2binl(e)),512+8*e.length);return this.binl2rstr(this.binl_md5(r.concat(a),640))},n.rstr2hex=function(t){try{this.hexcase}catch(e){this.hexcase=0}for(var n,i=this.hexcase?"0123456789ABCDEF":"0123456789abcdef",r="",s=0;s<t.length;s++)n=t.charCodeAt(s),r+=i.charAt(n>>>4&15)+i.charAt(15&n);return r},n.rstr2b64=function(t){try{this.b64pad}catch(e){this.b64pad=""}for(var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i="",r=t.length,s=0;r>s;s+=3)for(var a=t.charCodeAt(s)<<16|(r>s+1?t.charCodeAt(s+1)<<8:0)|(r>s+2?t.charCodeAt(s+2):0),o=0;4>o;o++)i+=8*s+6*o>8*t.length?this.b64pad:n.charAt(a>>>6*(3-o)&63);return i},n.rstr2any=function(t,e){var n,i,r,s,a,o=e.length,h=Array(Math.ceil(t.length/2));for(n=0;n<h.length;n++)h[n]=t.charCodeAt(2*n)<<8|t.charCodeAt(2*n+1);var c=Math.ceil(8*t.length/(Math.log(e.length)/Math.log(2))),l=Array(c);for(i=0;c>i;i++){for(a=Array(),s=0,n=0;n<h.length;n++)s=(s<<16)+h[n],r=Math.floor(s/o),s-=r*o,(a.length>0||r>0)&&(a[a.length]=r);l[i]=s,h=a}var u="";for(n=l.length-1;n>=0;n--)u+=e.charAt(l[n]);return u},n.str2rstr_utf8=function(t){for(var e,n,i="",r=-1;++r<t.length;)e=t.charCodeAt(r),n=r+1<t.length?t.charCodeAt(r+1):0,e>=55296&&56319>=e&&n>=56320&&57343>=n&&(e=65536+((1023&e)<<10)+(1023&n),r++),127>=e?i+=String.fromCharCode(e):2047>=e?i+=String.fromCharCode(192|e>>>6&31,128|63&e):65535>=e?i+=String.fromCharCode(224|e>>>12&15,128|e>>>6&63,128|63&e):2097151>=e&&(i+=String.fromCharCode(240|e>>>18&7,128|e>>>12&63,128|e>>>6&63,128|63&e));return i},n.str2rstr_utf16le=function(t){for(var e="",n=0;n<t.length;n++)e+=String.fromCharCode(255&t.charCodeAt(n),t.charCodeAt(n)>>>8&255);return e},n.str2rstr_utf16be=function(t){for(var e="",n=0;n<t.length;n++)e+=String.fromCharCode(t.charCodeAt(n)>>>8&255,255&t.charCodeAt(n));return e},n.rstr2binl=function(t){for(var e=Array(t.length>>2),n=0;n<e.length;n++)e[n]=0;for(var n=0;n<8*t.length;n+=8)e[n>>5]|=(255&t.charCodeAt(n/8))<<n%32;return e},n.binl2rstr=function(t){for(var e="",n=0;n<32*t.length;n+=8)e+=String.fromCharCode(t[n>>5]>>>n%32&255);return e},n.binl_md5=function(t,e){t[e>>5]|=128<<e%32,t[(e+64>>>9<<4)+14]=e;for(var n=1732584193,i=-271733879,r=-1732584194,s=271733878,a=0;a<t.length;a+=16){var o=n,h=i,c=r,l=s;n=this.md5_ff(n,i,r,s,t[a+0],7,-680876936),s=this.md5_ff(s,n,i,r,t[a+1],12,-389564586),r=this.md5_ff(r,s,n,i,t[a+2],17,606105819),i=this.md5_ff(i,r,s,n,t[a+3],22,-1044525330),n=this.md5_ff(n,i,r,s,t[a+4],7,-176418897),s=this.md5_ff(s,n,i,r,t[a+5],12,1200080426),r=this.md5_ff(r,s,n,i,t[a+6],17,-1473231341),i=this.md5_ff(i,r,s,n,t[a+7],22,-45705983),n=this.md5_ff(n,i,r,s,t[a+8],7,1770035416),s=this.md5_ff(s,n,i,r,t[a+9],12,-1958414417),r=this.md5_ff(r,s,n,i,t[a+10],17,-42063),i=this.md5_ff(i,r,s,n,t[a+11],22,-1990404162),n=this.md5_ff(n,i,r,s,t[a+12],7,1804603682),s=this.md5_ff(s,n,i,r,t[a+13],12,-40341101),r=this.md5_ff(r,s,n,i,t[a+14],17,-1502002290),i=this.md5_ff(i,r,s,n,t[a+15],22,1236535329),n=this.md5_gg(n,i,r,s,t[a+1],5,-165796510),s=this.md5_gg(s,n,i,r,t[a+6],9,-1069501632),r=this.md5_gg(r,s,n,i,t[a+11],14,643717713),i=this.md5_gg(i,r,s,n,t[a+0],20,-373897302),n=this.md5_gg(n,i,r,s,t[a+5],5,-701558691),s=this.md5_gg(s,n,i,r,t[a+10],9,38016083),r=this.md5_gg(r,s,n,i,t[a+15],14,-660478335),i=this.md5_gg(i,r,s,n,t[a+4],20,-405537848),n=this.md5_gg(n,i,r,s,t[a+9],5,568446438),s=this.md5_gg(s,n,i,r,t[a+14],9,-1019803690),r=this.md5_gg(r,s,n,i,t[a+3],14,-187363961),i=this.md5_gg(i,r,s,n,t[a+8],20,1163531501),n=this.md5_gg(n,i,r,s,t[a+13],5,-1444681467),s=this.md5_gg(s,n,i,r,t[a+2],9,-51403784),r=this.md5_gg(r,s,n,i,t[a+7],14,1735328473),i=this.md5_gg(i,r,s,n,t[a+12],20,-1926607734),n=this.md5_hh(n,i,r,s,t[a+5],4,-378558),s=this.md5_hh(s,n,i,r,t[a+8],11,-2022574463),r=this.md5_hh(r,s,n,i,t[a+11],16,1839030562),i=this.md5_hh(i,r,s,n,t[a+14],23,-35309556),n=this.md5_hh(n,i,r,s,t[a+1],4,-1530992060),s=this.md5_hh(s,n,i,r,t[a+4],11,1272893353),r=this.md5_hh(r,s,n,i,t[a+7],16,-155497632),i=this.md5_hh(i,r,s,n,t[a+10],23,-1094730640),n=this.md5_hh(n,i,r,s,t[a+13],4,681279174),s=this.md5_hh(s,n,i,r,t[a+0],11,-358537222),r=this.md5_hh(r,s,n,i,t[a+3],16,-722521979),i=this.md5_hh(i,r,s,n,t[a+6],23,76029189),n=this.md5_hh(n,i,r,s,t[a+9],4,-640364487),s=this.md5_hh(s,n,i,r,t[a+12],11,-421815835),r=this.md5_hh(r,s,n,i,t[a+15],16,530742520),i=this.md5_hh(i,r,s,n,t[a+2],23,-995338651),n=this.md5_ii(n,i,r,s,t[a+0],6,-198630844),s=this.md5_ii(s,n,i,r,t[a+7],10,1126891415),r=this.md5_ii(r,s,n,i,t[a+14],15,-1416354905),i=this.md5_ii(i,r,s,n,t[a+5],21,-57434055),n=this.md5_ii(n,i,r,s,t[a+12],6,1700485571),s=this.md5_ii(s,n,i,r,t[a+3],10,-1894986606),r=this.md5_ii(r,s,n,i,t[a+10],15,-1051523),i=this.md5_ii(i,r,s,n,t[a+1],21,-2054922799),n=this.md5_ii(n,i,r,s,t[a+8],6,1873313359),s=this.md5_ii(s,n,i,r,t[a+15],10,-30611744),r=this.md5_ii(r,s,n,i,t[a+6],15,-1560198380),i=this.md5_ii(i,r,s,n,t[a+13],21,1309151649),n=this.md5_ii(n,i,r,s,t[a+4],6,-145523070),s=this.md5_ii(s,n,i,r,t[a+11],10,-1120210379),r=this.md5_ii(r,s,n,i,t[a+2],15,718787259),i=this.md5_ii(i,r,s,n,t[a+9],21,-343485551),n=this.safe_add(n,o),i=this.safe_add(i,h),r=this.safe_add(r,c),s=this.safe_add(s,l)}return[n,i,r,s]},n.md5_cmn=function(t,e,n,i,r,s){return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(e,t),this.safe_add(i,s)),r),n)},n.md5_ff=function(t,e,n,i,r,s,a){return this.md5_cmn(e&n|~e&i,t,e,r,s,a)},n.md5_gg=function(t,e,n,i,r,s,a){return this.md5_cmn(e&i|n&~i,t,e,r,s,a)},n.md5_hh=function(t,e,n,i,r,s,a){return this.md5_cmn(e^n^i,t,e,r,s,a)},n.md5_ii=function(t,e,n,i,r,s,a){return this.md5_cmn(n^(e|~i),t,e,r,s,a)},n.safe_add=function(t,e){var n=(65535&t)+(65535&e),i=(t>>16)+(e>>16)+(n>>16);return i<<16|65535&n},n.bit_rol=function(t,e){return t<<e|t>>>32-e},t}();egret.registerClass(md5,"md5");var MessageCenter=function(t){function e(e){t.call(this),this.type=e,this.dict={},this.eVec=new Array,this.lastRunTime=0,0==this.type&&App.TimerManager.doFrame(1,0,this.run,this)}__extends(e,t);var n=(__define,e),i=n.prototype;return i.clear=function(){this.dict={},this.eVec.splice(0)},i.addListener=function(t,e,n){var i=this.dict[t];null==i&&(i=new Array,this.dict[t]=i);var r=0,s=i.length;for(r;s>r;r++)if(i[r][0]==e&&i[r][1]==n)return;i.push([e,n])},i.removeListener=function(t,e,n){var i=this.dict[t];if(null!=i){var r=0,s=i.length;for(r;s>r;r++)if(i[r][0]==e&&i[r][1]==n){i.splice(r,1);break}0==i.length&&(this.dict[t]=null,delete this.dict[t])}},i.removeAll=function(t){for(var e=Object.keys(this.dict),n=0,i=e.length;i>n;n++){for(var r=e[n],s=this.dict[r],a=0;a<s.length;a++)s[a][1]==t&&(s.splice(a,1),a--);0==s.length&&(this.dict[r]=null,delete this.dict[r])}},i.dispatch=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(null!=this.dict[t]){var i=ObjectPool.pop("MessageVo");i.type=t,i.param=e,0==this.type?this.eVec.push(i):1==this.type?this.dealMsg(i):Log.trace("MessageCenter未实现的类型")}},i.run=function(){var t=egret.getTimer(),e=t-this.lastRunTime>100;if(this.lastRunTime=t,e)for(;this.eVec.length>0;)this.dealMsg(this.eVec.shift());else for(;this.eVec.length>0&&(this.dealMsg(this.eVec.shift()),!(egret.getTimer()-t>5)););},i.dealMsg=function(t){for(var e=this.dict[t.type],n=0,i=e.length,r=null;i>n;)r=e[n],r[0].apply(r[1],t.param),e.length!=i&&(i=e.length,n--),n++;t.dispose(),ObjectPool.push(t)},e}(BaseClass);egret.registerClass(MessageCenter,"MessageCenter");var MessageVo=function(){function t(){}var e=(__define,t),n=e.prototype;return n.dispose=function(){this.type=null,this.param=null},t}();egret.registerClass(MessageVo,"MessageVo");var ObjectPool=function(){function t(){this._objs=new Array}var e=(__define,t),n=e.prototype;return n.pushObj=function(t){this._objs.push(t)},n.popObj=function(){return this._objs.length>0?this._objs.pop():null},n.clear=function(){for(;this._objs.length>0;)this._objs.pop()},t.pop=function(e){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];t._content[e]||(t._content[e]=[]);var r=t._content[e];if(r.length)return r.pop();var s,a=egret.getDefinitionByName(e),o=n.length;return 0==o?s=new a:1==o?s=new a(n[0]):2==o?s=new a(n[0],n[1]):3==o?s=new a(n[0],n[1],n[2]):4==o?s=new a(n[0],n[1],n[2],n[3]):5==o&&(s=new a(n[0],n[1],n[2],n[3],n[4])),s.ObjectPoolKey=e,s},t.popWithExtraKey=function(e,n){t._content[e]||(t._content[e]=[]);var i,r=t._content[e];if(r.length)for(var s=0;s<r.length;s++)if(r[s].extraKey==n){i=r[s],r.splice(s,1);break}if(!i){var a=egret.getDefinitionByName(e);i=new a(n),i.extraKey=n,i.ObjectPoolKey=e}return i},t.push=function(e){if(null==e)return!1;var n=e.ObjectPoolKey;return t._content[n]?(t._content[n].push(e),!0):!1},t.clear=function(){t._content={}},t.clearClass=function(e,n){void 0===n&&(n=null);for(var i=t._content[e];i&&i.length;){var r=i.pop();n&&r[n](),r=null}t._content[e]=null,delete t._content[e]},t.dealFunc=function(e,n){var i=t._content[e];if(null!=i){var r=0,s=i.length;for(r;s>r;r++)i[r][n]()}},t._content={},t}();egret.registerClass(ObjectPool,"ObjectPool");var Percent=function(){function t(t,e){this.currentValue=t,this.totalValue=e}var e=(__define,t),n=e.prototype;return n.computePercent=function(){return this.currentValue/this.totalValue*100},n.computeRate=function(){return this.currentValue/this.totalValue},n.reverse=function(){return this.currentValue=this.totalValue-this.currentValue,this},n.copy=function(){return new t(this.currentValue,this.totalValue)},n.computePercentReverse=function(){return(this.totalValue-this.currentValue)/this.totalValue*100},n.computeRateReverse=function(){return(this.totalValue-this.currentValue)/this.totalValue},t}();egret.registerClass(Percent,"Percent");var QueueExecutor=function(){function t(){this._functions=new Array}var e=(__define,t),n=e.prototype;return n.setCallBack=function(t,e){this._callBack=t,this._callBackTarget=e},n.regist=function(t,e){this._functions.push([t,e])},n.start=function(){this.next()},n.next=function(){if(this._functions)if(0==this._functions.length)this._callBack&&this._callBack.call(this._callBackTarget),this._callBack=null,this._callBackTarget=null,this._functions=null;else{var t=this._functions.shift();t[0].call(t[1])}},t}();egret.registerClass(QueueExecutor,"QueueExecutor");var RandomUtils=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var n=(__define,e),i=n.prototype;return i.limit=function(t,e){t=Math.min(t,e),e=Math.max(t,e);var n=e-t;return t+Math.random()*n},i.limitInteger=function(t,e){return Math.round(this.limit(t,e))},i.randomArray=function(t){var e=Math.floor(Math.random()*t.length);return t[e]},e}(BaseClass);egret.registerClass(RandomUtils,"RandomUtils");var RenderTextureManager=function(t){function e(){t.call(this),this._pool=[],this._useNum=0,this.isLowerQQBrowser()?this._maxNum=18:this._maxNum=-1}__extends(e,t);var n=(__define,e),i=n.prototype;return i.isLowerQQBrowser=function(){if(App.DeviceUtils.IsQQBrowser){for(var t=["2013022","Lenovo A630t","SM-G3818","vivo X3t","GT-I9100"],e=!1,n=0,i=t.length;i>n;n++)if(-1!=navigator.userAgent.indexOf(t[n])){e=!0;break}return e}return!1},i.pop=function(){var t=this._pool.pop();return t||(-1==this._maxNum||this._useNum<this._maxNum)&&(t=new egret.RenderTexture,this._useNum++),t},i.push=function(t){for(var e=!1,n=0,i=this._pool.length;i>n;n++)if(this._pool[n]==t){e=!0;break}e||this._pool.push(t)},e}(BaseClass);egret.registerClass(RenderTextureManager,"RenderTextureManager");var ResourceUtils=function(t){function e(){t.call(this),this._groupIndex=0,this._configs=new Array,this._groups={},RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceLoadProgress,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this)}__extends(e,t);var n=(__define,e),i=n.prototype;return i.addConfig=function(t,e){this._configs.push([t,e])},i.loadConfig=function(t,e){this._onConfigComplete=t,this._onConfigCompleteTarget=e,this.loadNextConfig()},i.loadNextConfig=function(){if(0==this._configs.length)return this._onConfigComplete.call(this._onConfigCompleteTarget),this._onConfigComplete=null,void(this._onConfigCompleteTarget=null);var t=this._configs.shift();RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigCompleteHandle,this),RES.loadConfig(t[0],t[1])},i.onConfigCompleteHandle=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigCompleteHandle,this),this.loadNextConfig()},i.loadGroup=function(t,e,n,i){this._groups[t]=[e,n,i],RES.loadGroup(t)},i.loadGroups=function(t,e,n,i,r){RES.createGroup(t,e,!0),this.loadGroup(t,n,i,r)},i.pilfererLoadGroup=function(t,e){void 0===e&&(e=null);var n="pilferer_"+t;e||(e=[t]),RES.createGroup(n,e,!0),RES.loadGroup(n,-1)},i.onResourceLoadComplete=function(t){var e=t.groupName;if(this._groups[e]){var n=this._groups[e][0],i=this._groups[e][2];null!=n&&n.call(i),this._groups[e]=null,delete this._groups[e]}},i.onResourceLoadProgress=function(t){var e=t.groupName;if(this._groups[e]){var n=this._groups[e][1],i=this._groups[e][2];null!=n&&n.call(i,t.itemsLoaded,t.itemsTotal)}},i.onResourceLoadError=function(t){Log.trace(t.groupName+"资源组有资源加载失败"),this.onResourceLoadComplete(t)},i.loadResource=function(t,e,n,i,r){void 0===t&&(t=[]),void 0===e&&(e=[]),void 0===n&&(n=null),void 0===i&&(i=null),void 0===r&&(r=null);var s=t.concat(e),a="loadGroup"+this._groupIndex++;RES.createGroup(a,s,!0),this._groups[a]=[n,i,r],RES.loadGroup(a)},e}(BaseClass);egret.registerClass(ResourceUtils,"ResourceUtils");var ResVersionManager=function(t){function e(){t.call(this),this.res_loadByVersion()}__extends(e,t);var n=(__define,e),i=n.prototype;return i.res_loadByVersion=function(){RES.web.Html5VersionController.prototype.getVirtualUrl=function(t){var n="",i=e.resVersionData,r=t.substring(9);return i&&i[r]&&(n=i[r]),0==n.length&&(n=Math.random()+""),t+=-1==t.indexOf("?")?"?v="+n:"&v="+n}},i.loadConfig=function(t,e,n){this.complateFunc=e,this.complateFuncTarget=n,RES.getResByUrl(t,this.loadResVersionComplate,this)},i.loadResVersionComplate=function(t){e.resVersionData=t,this.complateFunc.call(this.complateFuncTarget)},e}(BaseClass);egret.registerClass(ResVersionManager,"ResVersionManager");var RockerUtils=function(t){function e(){t.call(this)}__extends(e,t);var n=(__define,e),i=n.prototype;return i.init=function(t,e,n,i){this.keys=[0,0],this.mouseX=-1,this.mouseY=-1,this.moveFlag=e,this.moveFlagX=e.x,this.moveFlagY=e.y,this.moveFlagGoX=this.moveFlagX,this.moveFlagGoY=this.moveFlagY,this.moveFlagWidthHelf=.5*t.width,this.moveFlagRec=new egret.Rectangle(this.moveFlagX-.5*t.width,this.moveFlagY-.5*t.height,t.width,t.height),this.moveFlagCheckRec=new egret.Rectangle(0,0,.5*App.StageUtils.getWidth(),App.StageUtils.getHeight()),this.dealKeyFunc=n,this.dealKeyTarget=i,this.moveFlag.touchEnabled=!0,this.moveFlag.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.startMove,this),this.moveFlag.addEventListener(egret.TouchEvent.TOUCH_END,this.stopMove,this),this.moveFlag.addEventListener(egret.TouchEvent.TOUCH_TAP,this.stopEvent,this),App.StageUtils.getStage().addEventListener(egret.TouchEvent.TOUCH_END,this.leaveStateEvent,this),App.StageUtils.getStage().addEventListener(egret.TouchEvent.TOUCH_MOVE,this.heroMoveEvent,this),App.KeyboardUtils.addKeyDown(this.onKeyDown,this),App.KeyboardUtils.addKeyUp(this.onKeyUp,this)},i.onKeyDown=function(t){switch(t){case Keyboard.A:this.keys[0]=-1,this.startCheckKey();break;case Keyboard.D:this.keys[0]=1,this.startCheckKey();break;case Keyboard.W:this.keys[1]=-1,this.startCheckKey();break;case Keyboard.S:this.keys[1]=1,this.startCheckKey()}},i.onKeyUp=function(t){switch(t){case Keyboard.A:-1==this.keys[0]&&(this.keys[0]=0);break;case Keyboard.D:1==this.keys[0]&&(this.keys[0]=0);break;case Keyboard.W:-1==this.keys[1]&&(this.keys[1]=0);break;case Keyboard.S:1==this.keys[1]&&(this.keys[1]=0)}},i.stopEvent=function(t){t.stopPropagation()},i.leaveStateEvent=function(t){t.stageX==this.mouseX&&t.stageY==this.mouseY&&this.stopMove()},i.startMove=function(t){this.isMoveing=!0,this.moveFlagGoX=this.moveFlagX,this.moveFlagGoY=this.moveFlagY,this.mouseX=t.stageX,this.mouseY=t.stageY},i.stopMove=function(){this.isMoveing=!1,this.keys[0]=0,this.keys[1]=0,this.moveFlagGoX=this.moveFlagX,this.moveFlagGoY=this.moveFlagY,this.mouseX=-1,this.mouseY=-1},i.resetRockerPos=function(){this.moveFlag.x=this.moveFlagX,this.moveFlag.y=this.moveFlagY},i.heroMoveEvent=function(t){this.runMove(t.stageX,t.stageY)},i.runMove=function(t,e){if(this.isMoveing&&(this.moveFlagCheckRec.contains(t,e)||!(Math.abs(this.mouseX-t)>50||Math.abs(this.mouseY-e)>50))){if(this.mouseX=t,this.mouseY=e,this.moveFlagRec.contains(this.mouseX,this.mouseY))this.moveFlagGoX=this.mouseX,this.moveFlagGoY=this.mouseY;else{var n=App.MathUtils.getRadian2(this.moveFlagX,this.moveFlagY,this.mouseX,this.mouseY);this.moveFlagGoX=this.moveFlagX+Math.cos(n)*this.moveFlagWidthHelf,this.moveFlagGoY=this.moveFlagY+Math.sin(n)*this.moveFlagWidthHelf}this.moveFlagGoX>this.moveFlagX&&Math.abs(this.moveFlagGoX-this.moveFlagX)>10?this.keys[0]=1:this.moveFlagGoX<this.moveFlagX&&Math.abs(this.moveFlagGoX-this.moveFlagX)>10?this.keys[0]=-1:this.keys[0]=0,this.moveFlagGoY>this.moveFlagY&&Math.abs(this.moveFlagGoY-this.moveFlagY)>10?this.keys[1]=1:this.moveFlagGoY<this.moveFlagY&&Math.abs(this.moveFlagGoY-this.moveFlagY)>10?this.keys[1]=-1:this.keys[1]=0,this.startCheckKey()}},i.startCheckKey=function(){this.checkKeying||(this.checkKeying=!0,App.TimerManager.doFrame(1,0,this.delKeys,this))},i.stopCheckKey=function(){this.keys[0]=0,this.keys[1]=0,this.checkKeying&&(App.TimerManager.remove(this.delKeys,this),this.checkKeying=!1)},i.delKeys=function(){-1==this.mouseX||this.moveFlagCheckRec.contains(this.mouseX,this.mouseY)||this.stopMove(),this.moveFlag.x!=this.moveFlagGoX&&(this.moveFlag.x=this.moveFlagGoX),this.moveFlag.y!=this.moveFlagGoY&&(this.moveFlag.y=this.moveFlagGoY),this.keys[0]||this.keys[1]||this.stopCheckKey(),this.dealKeyFunc.call(this.dealKeyTarget,this.keys[0],this.keys[1])||this.resetRockerPos()},i.stop=function(){this.stopCheckKey(),this.stopMove()},e}(BaseClass);egret.registerClass(RockerUtils,"RockerUtils");var ShockUtils=function(t){function e(){t.call(this),this.MAP=0,this.SPRITE=1,this.mapPoss=[new egret.Point(0,3),new egret.Point(0,0),new egret.Point(0,-2)],this.spritePoss=[new egret.Point(5,0),new egret.Point(-5,0),new egret.Point(5,0)],this._shockLength=0,this._shockCount=0,this._rx=0,this._ry=0,this._type=0,this._repeatCount=0}__extends(e,t);var n=__define,i=e,r=i.prototype;return r.destroy=function(){this.stop()},r.shock=function(t,e,n){void 0===t&&(t=0),void 0===e&&(e=null),void 0===n&&(n=3),this._target||(this._type=t,this._target=e,this._type==this.MAP?(this._shockPoss=this.mapPoss.concat(),this._shockLength=this._shockPoss.length):this._type==this.SPRITE&&(this._shockPoss=this.spritePoss.concat(),this._shockLength=this._shockPoss.length),this.start(n))},r.start=function(t){void 0===t&&(t=1),this.repeatCount=t,this._shockCount=0,this._target&&(this._type!=this.MAP&&(this._rx=this._target.x),this._ry=this._target.y,App.TimerManager.doFrame(1,0,this.onShockEnter,this))},r.stop=function(){this._target&&(this._type!=this.MAP&&(this._target.x=this._rx),this._target.y=this._ry,App.TimerManager.remove(this.onShockEnter,this)),this._target=null},r.onShockEnter=function(t){var e=this._shockLength*this._repeatCount;if(this._shockCount>=e)return void this.stop();var n=this._shockCount%this._shockLength,i=this._shockPoss[n];this._target&&(this._type!=this.MAP&&(this._target.x=this._rx+i.x),this._target.y=this._ry+i.y),this._shockCount++},n(r,"repeatCount",function(){return this._repeatCount},function(t){this._repeatCount=t}),e}(BaseClass);egret.registerClass(ShockUtils,"ShockUtils");var StageUtils=function(t){function e(){t.call(this),null==e._uiStage&&(e._uiStage=new eui.UILayer,e._uiStage.percentHeight=100,e._uiStage.percentWidth=100,e._uiStage.touchEnabled=!1,this.getStage().addChild(e._uiStage))}__extends(e,t);var n=(__define,e),i=n.prototype;return i.getHeight=function(){return this.getStage().stageHeight},i.getWidth=function(){return this.getStage().stageWidth},i.setTouchChildren=function(t){this.getStage().touchChildren=t},i.setMaxTouches=function(t){this.getStage().maxTouches=t},i.setFrameRate=function(t){this.getStage().frameRate=t},i.setScaleMode=function(t){this.getStage().scaleMode=t},i.getStage=function(){return egret.MainContext.instance.stage},i.getUIStage=function(){return e._uiStage},e}(BaseClass);egret.registerClass(StageUtils,"StageUtils");var StringBuffer=function(){function t(){this._strings=new Array}var e=(__define,t),n=e.prototype;return n.append=function(t){this._strings.push(t)},n.toString=function(){return this._strings.join("")},n.clear=function(){this._strings.length=0},t}();egret.registerClass(StringBuffer,"StringBuffer");var StringUtils=function(t){function e(){t.call(this)}__extends(e,t);var n=(__define,e),i=n.prototype;return i.trimSpace=function(t){return t.replace(/^\s*(.*?)[\s\n]*$/g,"$1")},i.getStringLength=function(t){for(var e=t.split(""),n=0,i=0;i<e.length;i++){var r=e[i];n+=this.isChinese(r)?2:1}return n},i.isChinese=function(t){var e=/^.*[\u4E00-\u9FA5]+.*$/;return e.test(t)},e}(BaseClass);egret.registerClass(StringUtils,"StringUtils");var TextFlowMaker=function(t){function e(){t.call(this),this.STYLE_COLOR="C",this.STYLE_SIZE="S",this.PROP_TEXT="T"}__extends(e,t);var n=(__define,e),i=n.prototype;return i.generateTextFlow=function(t){for(var e=t.split("|"),n=[],i=0,r=e.length;r>i;i++)n.push(this.getSingleTextFlow(e[i]));return n},i.getSingleTextFlow=function(t){for(var e,n=t.split("&"),i={style:{}},r=0,s=n.length;s>r;r++)e=n[r].split(":"),e[0]==this.PROP_TEXT?i.text=e[1]:e[0]==this.STYLE_SIZE?i.style.size=parseInt(e[1]):e[0]==this.STYLE_COLOR?i.style.textColor=parseInt(e[1]):i.text=e[0];return i},e}(BaseClass);egret.registerClass(TextFlowMaker,"TextFlowMaker");var TimerManager=function(t){function e(){t.call(this),this._handlers=new Array,this._delHandlers=new Array,this._currTime=egret.getTimer(),this._currFrame=0,this._count=0,this._timeScale=1,egret.Ticker.getInstance().register(this.onEnterFrame,this)}__extends(e,t);var n=__define,i=e,r=i.prototype;return r.setTimeScale=function(t){this._timeScale=t},r.onEnterFrame=function(){this._currFrame++,this._currTime=egret.getTimer(),App.DebugUtils.start("TimerManager:");for(var t=0;t<this._count;t++){var e=this._handlers[t],n=e.userFrame?this._currFrame:this._currTime;n>=e.exeTime&&(App.DebugUtils.start(e.method.toString()),e.method.call(e.methodObj,(this._currTime-e.dealTime)*this._timeScale),App.DebugUtils.stop(e.method.toString()),e.dealTime=this._currTime,e.exeTime+=e.delay,e.repeat||(e.repeatCount>1?e.repeatCount--:(e.complateMethod&&e.complateMethod.apply(e.complateMethodObj),this._delHandlers.push(e))))}for(;this._delHandlers.length;){var e=this._delHandlers.pop();this.remove(e.method,e.methodObj)}App.DebugUtils.stop("TimerManager:")},r.create=function(t,e,n,i,r,s,a){if(!(0>e||0>n||null==i)){this.remove(i,r);var o=ObjectPool.pop("TimerHandler");o.userFrame=t,o.repeat=0==n,o.repeatCount=n,o.delay=e,o.method=i,o.methodObj=r,o.complateMethod=s,o.complateMethodObj=a,o.exeTime=e+(t?this._currFrame:this._currTime),o.dealTime=this._currTime,this._handlers.push(o),this._count++}},r.doTimer=function(t,e,n,i,r,s){void 0===r&&(r=null),void 0===s&&(s=null),this.create(!1,t,e,n,i,r,s)},r.doFrame=function(t,e,n,i,r,s){void 0===r&&(r=null),void 0===s&&(s=null),this.create(!0,t,e,n,i,r,s)},n(r,"count",function(){return this._count}),r.remove=function(t,e){for(var n=0;n<this._count;n++){var i=this._handlers[n];if(i.method==t&&i.methodObj==e){this._handlers.splice(n,1),ObjectPool.push(i),this._count--;break}}},r.removeAll=function(t){for(var e=0;e<this._count;e++){var n=this._handlers[e];n.methodObj==t&&(this._handlers.splice(e,1),ObjectPool.push(n),this._count--,e--)}},r.isExists=function(t,e){for(var n=0;n<this._count;n++){var i=this._handlers[n];if(i.method==t&&i.methodObj==e)return!0}return!1},e}(BaseClass);egret.registerClass(TimerManager,"TimerManager");var TimerHandler=function(){function t(){this.delay=0,this.repeatCount=0,this.exeTime=0,this.dealTime=0}var e=(__define,t),n=e.prototype;return n.clear=function(){this.method=null,this.methodObj=null,this.complateMethod=null,this.complateMethodObj=null},t}();egret.registerClass(TimerHandler,"TimerHandler");